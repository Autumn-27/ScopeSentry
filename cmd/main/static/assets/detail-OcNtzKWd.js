import{d as e,r as a,U as l,M as u,a5 as o,o as t,i as r,w as n,e as i,a as s,A as d,c as p,Q as m,F as v,B as c,z as b,l as g,_ as f}from"./index-DZkrNvQC.js";import{a as _,E as y}from"./el-form-BfI3XjdN.js";import"./el-tag-BLiRkvOU.js";import{E as S,b as V}from"./el-select-Cg9roJ9C.js";import"./el-popper-VZvChD93.js";import{E as h,a as j}from"./el-col-s8XiVykl.js";import{j as U,o as w,T as x}from"./index-0z97GjXd.js";import{i as P,s as A}from"./index-CcNl0Xcx.js";import"./castArray-M4B-XqAz.js";import"./strings-6KyoKaer.js";import"./index-0WqnF4zs.js";import"./useInput-DMGD1XhZ.js";import"./debounce-ZoOD6Jtd.js";import"./index-D7sIarE1.js";const L=f(e({__name:"detail",props:{closeDialog:{type:Function},getList:{type:Function},id:{}},setup(e){const{t:f}=g(),L=e,F=a({name:"",version:"",module:"",parameter:"",help:"",introduction:"",source:""}),H=()=>{F.value={name:"",version:"",module:"",parameter:"",help:"",introduction:"",source:""},C.value=""},I=a({name:[{required:!0,message:"",trigger:"blur"}],module:[{required:!0,message:"",trigger:"change"}],source:[{required:!0,message:"",trigger:"blur"}]}),k=a([{label:"TargetHandler",value:"TargetHandler"},{label:"SubdomainScan",value:"SubdomainScan"},{label:"SubdomainSecurity",value:"SubdomainSecurity"},{label:"PortScanPreparation",value:"PortScanPreparation"},{label:"PortScan",value:"PortScan"},{label:"AssetMapping",value:"AssetMapping"},{label:"URLScan",value:"URLScan"},{label:"WebCrawler",value:"WebCrawler"},{label:"DirScan",value:"DirScan"},{label:"VulnerabilityScan",value:"VulnerabilityScan"},{label:"AssetHandle",value:"AssetHandle"},{label:"PortFingerprint",value:"PortFingerprint"},{label:"URLSecurity",value:"URLSecurity"},{label:"PassiveScan",value:"PassiveScan"}]),C=a(""),D=[U(),w];l((async()=>{H(),L.id&&await z(L.id)}));const R=a("");(()=>{const e=localStorage.getItem("plugin_key");R.value=e})();const q=a(!1),z=async e=>{try{const a=await P(e);if(200===a.code){const e=a.data;F.value.name=e.name,F.value.version=e.version,F.value.module=e.module,F.value.parameter=e.parameter,F.value.help=e.help,F.value.introduction=e.introduction,C.value=e.source,q.value=e.isSystem}else u.error(`数据加载失败：${a.message}`)}catch(a){}},E=a(!1);o((()=>L.id),(async e=>{""===e?H():await z(e)}));const M=async()=>{if(E.value=!0,""==F.value.name)return u.error("name 不能为空"),void(E.value=!1);if(""==F.value.module)return u.error("module 不能为空"),void(E.value=!1);if(!q.value&&""==C.value)return u.error("源码 不能为空"),void(E.value=!1);try{505==(await A(L.id,F.value.name,F.value.version,F.value.module,F.value.parameter,F.value.help,F.value.introduction,C.value,R.value)).code&&localStorage.removeItem("plugin_key"),L.closeDialog(),L.getList()}catch(e){u.error("保存失败，请稍后再试。")}finally{E.value=!1}};return(e,a)=>(t(),r(s(y),{model:F.value,rules:I.value,"label-width":"100px"},{default:n((()=>[i(s(j),{gutter:20},{default:n((()=>[i(s(h),{span:12},{default:n((()=>[i(s(_),{label:s(f)("plugin.name"),prop:"name"},{default:n((()=>[i(s(d),{modelValue:F.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>F.value.name=e),disabled:q.value},null,8,["modelValue","disabled"])])),_:1},8,["label"])])),_:1}),i(s(h),{span:12},{default:n((()=>[i(s(_),{label:s(f)("plugin.module"),prop:"module"},{default:n((()=>[i(s(S),{modelValue:F.value.module,"onUpdate:modelValue":a[1]||(a[1]=e=>F.value.module=e),disabled:q.value},{default:n((()=>[(t(!0),p(v,null,m(k.value,(e=>(t(),r(s(V),{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1},8,["label"])])),_:1}),i(s(h),{span:12},{default:n((()=>[i(s(_),{label:s(f)("plugin.parameter"),prop:"parameter"},{default:n((()=>[i(s(d),{modelValue:F.value.parameter,"onUpdate:modelValue":a[2]||(a[2]=e=>F.value.parameter=e)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),i(s(h),{span:12},{default:n((()=>[i(s(_),{label:s(f)("plugin.help"),prop:"help"},{default:n((()=>[i(s(d),{modelValue:F.value.help,"onUpdate:modelValue":a[3]||(a[3]=e=>F.value.help=e)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),i(s(h),{span:12},{default:n((()=>[i(s(_),{label:s(f)("plugin.version"),prop:"version"},{default:n((()=>[i(s(d),{modelValue:F.value.version,"onUpdate:modelValue":a[4]||(a[4]=e=>F.value.version=e),disabled:q.value},null,8,["modelValue","disabled"])])),_:1},8,["label"])])),_:1}),i(s(h),{span:24},{default:n((()=>[i(s(_),{label:s(f)("plugin.introduction"),prop:"introduction"},{default:n((()=>[i(s(d),{modelValue:F.value.introduction,"onUpdate:modelValue":a[5]||(a[5]=e=>F.value.introduction=e)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),i(s(h),{span:24},{default:n((()=>[i(s(_),{label:"源码",prop:"source"},{default:n((()=>[i(s(x),{modelValue:C.value,"onUpdate:modelValue":a[6]||(a[6]=e=>C.value=e),style:{height:"400px",width:"90%"},autofocus:!0,"indent-with-tab":!0,"tab-size":2,extensions:D,disabled:q.value},null,8,["modelValue","disabled"])])),_:1})])),_:1})])),_:1}),i(s(j),null,{default:n((()=>[i(s(h),{span:12,style:{"text-align":"right"}},{default:n((()=>[i(s(c),{type:"primary",onClick:M,loading:E.value},{default:n((()=>[b(" 保存 ")])),_:1},8,["loading"])])),_:1})])),_:1})])),_:1},8,["model","rules"]))}}),[["__scopeId","data-v-13e80fb0"]]);export{L as default};
