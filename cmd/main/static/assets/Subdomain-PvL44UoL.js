import{d as e,dC as t,H as l,r as a,s as o,e as s,z as i,F as n,A as r,o as m,i as u,w as d,a as p,B as c,j as h,J as f,l as b,K as j,M as g,_ as v}from"./index-DZkrNvQC.js";import{u as y}from"./useTable-Dd87HoFf.js";import{E as x}from"./el-card-DJlZ0CLo.js";import{E as S,a as _}from"./el-col-s8XiVykl.js";import{E as w}from"./el-text-DhQDCxty.js";import{_ as C}from"./Table.vue_vue_type_script_lang-Dkl0dTPC.js";import{u as E}from"./useCrudSchemas-9XwzuZam.js";import{d as A}from"./index-BQdBp7dW.js";import{A as T}from"./index-GB9WWiKe.js";import"./el-table-column-Cf4Hjyif.js";import"./el-popper-VZvChD93.js";import"./index-0WqnF4zs.js";import"./debounce-ZoOD6Jtd.js";import"./el-checkbox-DD3shB1l.js";import"./isArrayLikeObject-DI26AvnP.js";import"./raf-D_pBdXgG.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-tag-BLiRkvOU.js";import"./el-pagination-8Xi09ZRF.js";import"./el-select-Cg9roJ9C.js";import"./strings-6KyoKaer.js";import"./useInput-DMGD1XhZ.js";import"./el-image-viewer-DNoNmynu.js";import"./el-empty-bmuKy-Tq.js";import"./tsxHelper-DrSyVvbf.js";import"./el-dropdown-item-BykouGbZ.js";import"./castArray-M4B-XqAz.js";import"./refs-VHbxD1oy.js";import"./index-CFOhGeju.js";import"./tree-BfZhwLPs.js";import"./index-D7sIarE1.js";function N(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!f(e)}const W=v(e({__name:"Subdomain",setup(e){const{t:f}=b(),{query:v}=t();l((()=>{z(),window.addEventListener("resize",z)}));const W=a(0),z=()=>{const e=window.innerHeight||document.documentElement.clientHeight;W.value=.8*e};a("");const I=o({});I.project=[v.id];const R=async e=>{Object.assign(I,e),M()},V=o([{field:"selection",type:"selection",minWidth:"55"},{field:"index",label:f("tableDemo.index"),type:"index",minWidth:"30"},{field:"host",label:f("subdomain.subdomainName"),minWidth:"200",formatter:(e,t,l)=>e.count?s(n,null,[s(w,null,N(l)?l:{default:()=>[l]}),s(w,{type:"info"},{default:()=>[i("("),e.count,i(")")]})]):s(w,null,N(l)?l:{default:()=>[l]}),slots:{header:()=>s("div",null,[s("span",null,[f("subdomain.subdomainName")]),s(r,{modelValue:F.value,"onUpdate:modelValue":e=>F.value=e,placeholder:"Search",style:"width: 200px; margin-left: 10px;",size:"small",onChange:()=>J("sub_host")},null)])}},{field:"type",label:f("subdomain.recordType"),minWidth:"200",columnKey:"type",filters:[{text:"A",value:"A"},{text:"NS",value:"NS"},{text:"CNAME",value:"CNAME"},{text:"PTR",value:"PTR"},{text:"TXT",value:"TXT"}]},{field:"value",label:f("subdomain.recordValue"),minWidth:"250",formatter:(e,t,l)=>{let a="";return l.forEach(((e,t)=>{a+=`${e}\r\n`})),a},slots:{header:()=>s("div",null,[s("span",null,[f("subdomain.recordValue")]),s(r,{modelValue:P.value,"onUpdate:modelValue":e=>P.value=e,placeholder:"Search",style:"width: 200px; margin-left: 10px;",size:"small",onChange:()=>J("sub_value")},null)])}},{field:"ip",label:"IP",minWidth:"150",formatter:(e,t,l)=>{let a="";return l.forEach(((e,t)=>{a+=`${e}\r\n`})),a},slots:{header:()=>s("div",null,[s("span",null,[i("IP")]),s(r,{modelValue:$.value,"onUpdate:modelValue":e=>$.value=e,placeholder:"Search",style:"width: 180px; margin-left: 10px;",size:"small",onChange:()=>J("sub_ip")},null)])}},{field:"time",label:f("asset.time"),minWidth:"200"}]),{allSchemas:k}=E(V),{tableRegister:H,tableState:U,tableMethods:B}=y({fetchDataApi:async()=>({list:(await A("",I,q)).data.list}),immediate:!0}),{loading:K,dataList:L}=U,{getList:M,getElTableExpose:O}=B;function D(){return{background:"var(--el-fill-color-light)"}}const F=a(""),P=a(""),$=a(""),q=o({}),J=async e=>{let t="";"sub_host"==e&&(t=F.value),"sub_value"==e&&(t=P.value),"sub_ip"==e&&(t=$.value),q[e]=t,M()},X=a([]),G=async()=>{j.confirm("Whether to delete?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then((async()=>{const e=await O(),t=(null==e?void 0:e.getSelectionRows())||[];X.value=t.map((e=>e.id)),await T(X.value,"subdomain"),M()})).catch((()=>{g({type:"info",message:"Delete canceled"})}))};let Q=a(!1);const Y=async()=>{const e=await O(),t=(null==e?void 0:e.getSelectionRows())||[];X.value=t.map((e=>e.id)),0!=X.value.length?Q.value=!0:Q.value=!1};return(e,t)=>(m(),u(p(_),null,{default:d((()=>[s(p(S),null,{default:d((()=>[s(p(x),{style:{height:"min-content"}},{default:d((()=>[p(Q)?(m(),u(p(c),{key:0,onClick:G,type:"danger",size:"small"},{default:d((()=>[i("Dlete")])),_:1})):h("",!0),s(p(C),{columns:p(k).tableColumns,data:p(L),stripe:"","max-height":W.value,border:!0,loading:p(K),onSelectionChange:Y,rowKey:"id",resizable:!0,onRegister:p(H),onFilterChange:R,headerCellStyle:D,style:{fontFamily:"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji"}},null,8,["columns","data","max-height","loading","onRegister"])])),_:1})])),_:1})])),_:1}))}}),[["__scopeId","data-v-74d55aa1"]]);export{W as default};
