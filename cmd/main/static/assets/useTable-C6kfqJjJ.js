import{l as a,r as t,a5 as e,a as s,H as n,K as l,M as o,X as c}from"./index-BtXGhrg7.js";const{t:i}=a(),u=a=>{const{immediate:u=!0}=a,m=t(!1),r=t(1),d=t(20),g=t(0),y=t([]);e((()=>r.value),(()=>{w.getList()})),e((()=>d.value),(()=>{1===s(r)||(r.value=1),w.getList()})),n((()=>{u&&w.getList()}));const v=t(),f=t(),p=async()=>{await c();const a=s(v);return a},w={getList:async()=>{m.value=!0;try{const t=await(null==a?void 0:a.fetchDataApi());t&&(y.value=t.list,t.flag||(g.value=t.total||0))}catch(t){}finally{m.value=!1}},setProps:async(a={})=>{const t=await p();null==t||t.setProps(a)},setColumn:async a=>{const t=await p();null==t||t.setColumn(a)},addColumn:async(a,t)=>{const e=await p();null==e||e.addColumn(a,t)},delColumn:async a=>{const t=await p();null==t||t.delColumn(a)},getElTableExpose:async()=>(await p(),s(f)),refresh:()=>{w.getList()},delList:async t=>{const{fetchDelApi:e}=a;e&&l.confirm(i("common.delMessage"),i("common.delWarning"),{confirmButtonText:i("common.delOk"),cancelButtonText:i("common.delCancel"),type:"warning"}).then((async()=>{if(await e()){o.success(i("common.delSuccess"));const a=(s(g)%s(d)===t||1===s(d))&&s(r)>1?s(r)-1:s(r);r.value=a,w.getList()}}))}};return{tableRegister:(a,t)=>{v.value=a,f.value=s(t)},tableMethods:w,tableState:{currentPage:r,pageSize:d,total:g,dataList:y,loading:m}}};export{u};
