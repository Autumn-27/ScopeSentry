import{u as t,a0 as n}from"./three.BbguFgn81764683399638.js";import{N as o,K as i,d as e}from"./@tresjs.CJvYCGUA1764683399638.js";import{_ as s}from"./component.vue_vue_type_script_setup_true_lang.CElxAbgG1764683399638.js";import{_ as a}from"./index.DM693cYN1764683399638.js";import{P as r}from"./tweakpane.CqZAnw7f1764683399638.js";import{d as p,$ as u,w as l,G as m,o as c,H as d,u as v,r as g,e as f,f as S,I as j,h,ah as P,m as x}from"./@vue.DjQnunkc1764683399638.js";import"./postprocessing.DjqPXL_K1764683399638.js";import"./@vueuse.BBrxj3Xz1764683399638.js";import"./three-stdlib.CqpxBIJB1764683399638.js";import"./useLoader.VuwfYjb91764683399638.js";import"./@fesjs.CQdxRiFD1764683399638.js";import"./vue-router.CW9J5iK31764683399638.js";import"./lodash-es.DWe8oqPO1764683399638.js";import"./pinia.yp40krTn1764683399638.js";import"./@qlin.y-0Z8WnK1764683399638.js";import"./@babel.BPq7uOAK1764683399638.js";import"./@floating-ui.Bhq4ibgf1764683399638.js";import"./@juggle.Vc7cP4_P1764683399638.js";import"./chalk.BHLFMujs1764683399638.js";/* empty css                                 */import"./iconify-icon.Dg3Wmqac1764683399638.js";import"./@iconify.Db0UMRdG1764683399638.js";import"./vite-plugin-qiankun.B06WoCqG1764683399638.js";import"./dompurify.C4MEnGDh1764683399638.js";import"./color.D_UQSrzA1764683399638.js";import"./color-string.cWrXb_cU1764683399638.js";import"./color-name.gyPnsvCn1764683399638.js";import"./lodash.OvYRBTRe1764683399638.js";import"./@amap.fjyZdsU91764683399638.js";import"./object-hash.C0HZ2EUZ1764683399638.js";import"./jszip.CqykFGTv1764683399638.js";import"./oimophysics.CfVKSiAm1764683399638.js";import"./@pmndrs.CRF-_adI1764683399638.js";import"./axios.Bl1IyXmH1764683399638.js";const R=["object"],_=p({__name:"com",props:{uSnappingResolution:{default:6},srcMaterial:{default:()=>new t({color:65280,roughness:.5,metalness:.5})}},setup(t){const n=t,o=u(n.uSnappingResolution);return n.srcMaterial.onBeforeCompile=t=>{t.uniforms.uSnappingResolution=o,t.vertexShader=t.vertexShader.replace("#include <common>","\n\t\t\t#include <common>\n\t\t\tuniform float uSnappingResolution;\n\t"),t.vertexShader=t.vertexShader.replace("#include <project_vertex>","\n\t\t\tvec4 mvPosition = vec4( transformed, 1.0 );\n\n\t\t\t#ifdef USE_BATCHING\n\t\t\t\tmvPosition = batchingMatrix * mvPosition;\n\t\t\t#endif\n\n\t\t\t#ifdef USE_INSTANCING\n\t\t\t\tmvPosition = instanceMatrix * mvPosition;\n\t\t\t#endif\n\n\t\t\tmvPosition = modelMatrix * mvPosition;\n\n\t\t\tmvPosition = vec4(\n\t\t\t\tround(mvPosition.x * uSnappingResolution) / uSnappingResolution,\n\t\t\t\tround(mvPosition.y * uSnappingResolution) / uSnappingResolution,\n\t\t\t\tround(mvPosition.z * uSnappingResolution) / uSnappingResolution,\n\t\t\t\t1.0);\n\t\t\tmvPosition = viewMatrix * mvPosition;\n\t\t\tgl_Position = projectionMatrix * mvPosition;\n\t")},l(()=>n.uSnappingResolution,t=>{o.value=t}),(t,n)=>(c(),m("primitive",{object:t.srcMaterial},null,8,R))}});const y=["object"],M=p({__name:"model",props:{uSnappingResolution:{default:6}},setup(t){const n=t,{state:i,materials:e}=o("https://opensource.cdn.icegl.cn/model/industry4/MRBike.glb",{draco:!0,decoderPath:"./draco/"}),s=[];return l(()=>i.value,t=>{t?.scene&&Object.values(e.value).forEach(t=>{s.push(function(t,n=6){const o={value:n};return t.onBeforeCompile=t=>{t.uniforms.uSnappingResolution=o,t.vertexShader=t.vertexShader.replace("#include <common>","\n\t\t\t\t#include <common>\n\t\t\t\tuniform float uSnappingResolution;\n\t\t"),t.vertexShader=t.vertexShader.replace("#include <project_vertex>","\n\t\t\t\tvec4 mvPosition = vec4( transformed, 1.0 );\n\t\n\t\t\t\t#ifdef USE_BATCHING\n\t\t\t\t\tmvPosition = batchingMatrix * mvPosition;\n\t\t\t\t#endif\n\t\n\t\t\t\t#ifdef USE_INSTANCING\n\t\t\t\t\tmvPosition = instanceMatrix * mvPosition;\n\t\t\t\t#endif\n\t\n\t\t\t\tmvPosition = modelMatrix * mvPosition;\n\t\n\t\t\t\tmvPosition = vec4(\n\t\t\t\t\tround(mvPosition.x * uSnappingResolution) / uSnappingResolution,\n\t\t\t\t\tround(mvPosition.y * uSnappingResolution) / uSnappingResolution,\n\t\t\t\t\tround(mvPosition.z * uSnappingResolution) / uSnappingResolution,\n\t\t\t\t\t1.0);\n\t\t\t\tmvPosition = viewMatrix * mvPosition;\n\t\t\t\tgl_Position = projectionMatrix * mvPosition;\n\t\t")},o}(t,n.uSnappingResolution))})}),l(()=>n.uSnappingResolution,t=>{s.forEach(n=>{n.value=t})}),(t,n)=>v(i)?(c(),m("primitive",{key:0,object:v(i)?.scene,scale:5,position:[0,-2,0]},null,8,y)):d("",!0)}}),b={position:[5,.9,-5],name:"torus"},T=p({__name:"vertexSnapping",setup(t){const o=g({alpha:!0,toneMapping:n,windowSize:!0,clearColor:"#000000"}),p=g({uSnappingResolution:3,modelSnappingResolution:6}),u=new r;return u.addBinding(p,"uSnappingResolution",{label:"圆环扭结-分辨率",min:0,max:20,step:.01}),u.addBinding(p,"modelSnappingResolution",{label:"自行车模型-分辨率",min:0,max:20,step:.01}),(t,n)=>(c(),f(v(e),x(o,{"window-size":""}),{default:S(()=>[n[1]||(n[1]=j("TresPerspectiveCamera",{position:[8,6,8],fov:45,near:1,far:1e3},null,-1)),h(v(i)),n[2]||(n[2]=j("TresAmbientLight",{intensity:.5},null,-1)),n[3]||(n[3]=j("TresDirectionalLight",{position:[7,10,-5.5],intensity:5},null,-1)),n[4]||(n[4]=j("TresMesh",{position:[-5,.5,5],"receive-shadow":"","cast-shadow":"",name:"cube"},[j("TresCylinderGeometry",{args:[1.5,1.5,2]}),j("TresMeshStandardMaterial",{color:16737826,roughness:0,metalness:0})],-1)),j("TresMesh",b,[n[0]||(n[0]=j("TresTorusKnotGeometry",{args:[1,.35,100,32]},null,-1)),h(_,{uSnappingResolution:p.uSnappingResolution},null,8,["uSnappingResolution"])]),(c(),f(P,null,{default:S(()=>[h(M,{uSnappingResolution:p.modelSnappingResolution},null,8,["uSnappingResolution"])]),_:1})),(c(),f(P,null,{default:S(()=>[h(v(s),{resolution:256,blur:1,background:""},{default:S(()=>[h(v(a),{intensity:2,form:"circle","rotation-x":Math.PI/2,position:[2,4,0],scale:[1,5,0]},null,8,["rotation-x"]),h(v(a),{intensity:2,form:"circle","rotation-x":Math.PI/2,position:[-6,4,0],scale:[1,5,0]},null,8,["rotation-x"]),h(v(a),{intensity:1,"rotation-y":-Math.PI/2,position:[-1,0,0],scale:[10,.2,1]},null,8,["rotation-y"]),h(v(a),{intensity:1,"rotation-y":-Math.PI/2,position:[1,0,0],scale:[10,.2,1]},null,8,["rotation-y"])]),_:1})]),_:1}))]),_:1},16))}});export{T as default};
