import{_ as e}from"./@fesjs.CQdxRiFD1764683399638.js";import"./index.DM693cYN1764683399638.js";import{l as a}from"./bubbleLoading.BU0KzqvC1764683399638.js";import{_ as t}from"./ScrollControls.vue_vue_type_script_setup_true_lang.BhGXzgTJ1764683399638.js";import{P as r}from"./tweakpane.CqZAnw7f1764683399638.js";import{v as o,b1 as s,b2 as n,i,j as l,o as u,q as c,l as m,bJ as p,k as d,J as v,A as f,aD as x,d9 as g,a1 as h,O as y,b as j,cL as w,cR as P,cS as b,d as _,r as M,cT as z,ad as S,as as T}from"./three.BbguFgn81764683399638.js";import{N as A,_ as B,F as C}from"./@tresjs.CJvYCGUA1764683399638.js";import{l as F}from"./util.Bz2eiElJ1764683399638.js";import{d as D,G as R,o as U,u as k,a as I,ad as q,w as L,e as J,a3 as V,r as G,b as O,h as Y,I as N,f as X,ah as E,a9 as W,aa as H,F as K}from"./@vue.DjQnunkc1764683399638.js";import"./vue-router.CW9J5iK31764683399638.js";import"./lodash-es.DWe8oqPO1764683399638.js";import"./pinia.yp40krTn1764683399638.js";import"./@qlin.y-0Z8WnK1764683399638.js";import"./@babel.BPq7uOAK1764683399638.js";import"./@floating-ui.Bhq4ibgf1764683399638.js";import"./@juggle.Vc7cP4_P1764683399638.js";import"./chalk.BHLFMujs1764683399638.js";/* empty css                                 */import"./iconify-icon.Dg3Wmqac1764683399638.js";import"./@iconify.Db0UMRdG1764683399638.js";import"./vite-plugin-qiankun.B06WoCqG1764683399638.js";import"./dompurify.C4MEnGDh1764683399638.js";import"./color.D_UQSrzA1764683399638.js";import"./color-string.cWrXb_cU1764683399638.js";import"./color-name.gyPnsvCn1764683399638.js";import"./lodash.OvYRBTRe1764683399638.js";import"./@amap.fjyZdsU91764683399638.js";import"./object-hash.C0HZ2EUZ1764683399638.js";import"./jszip.CqykFGTv1764683399638.js";import"./oimophysics.CfVKSiAm1764683399638.js";import"./three-stdlib.CqpxBIJB1764683399638.js";import"./@pmndrs.CRF-_adI1764683399638.js";import"./axios.Bl1IyXmH1764683399638.js";import"./@vueuse.BBrxj3Xz1764683399638.js";import"./postprocessing.DjqPXL_K1764683399638.js";const Q=e=>{let a=e.attributes.position.count,t=Math.ceil(Math.sqrt(a)),r=Math.ceil(a/t),i=new Float32Array(t*r*4);!function(e){for(let a=Math.floor(e.length/3)-1;a>0;a--){const t=Math.floor(Math.random()*(a+1));for(let r=0;r<3;r++){let o=e[3*a+r];e[3*a+r]=e[3*t+r],e[3*t+r]=o}}}(e.attributes.position.array);for(let o=0;o<a;o++){const a=e.attributes.position.array[3*o+0],t=e.attributes.position.array[3*o+1],r=e.attributes.position.array[3*o+2],s=0;i[4*o+0]=a,i[4*o+1]=t,i[4*o+2]=r,i[4*o+3]=s}let l=new o(i,t,r,s,n);return l.needsUpdate=!0,l},Z=()=>{const e=new c({uniforms:{uTextureA:{value:null},uTextureB:{value:null},uTime:{value:0},uScroll:{value:0}},vertexShader:"varying vec2 vUv;\r\nvoid main() {\r\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n  vUv = uv;\r\n}",fragmentShader:"uniform sampler2D uTextureA;\r\nuniform sampler2D uTextureB;\r\nprecision mediump float; \nuniform float uTime;\r\nuniform float uScroll;\r\nvarying vec2 vUv;\n\nmat3 rotationMatrix3(vec3 axis, float angle) {\r\n  axis = normalize(axis);\r\n  float s = sin(angle);\r\n  float c = cos(angle);\r\n  float oc = 1. - c;\n\n  return mat3(oc * axis.x * axis.x + c, oc * axis.x * axis.y - axis.z * s,\r\n              oc * axis.z * axis.x + axis.y * s,\r\n              oc * axis.x * axis.y + axis.z * s, oc * axis.y * axis.y + c,\r\n              oc * axis.y * axis.z - axis.x * s,\r\n              oc * axis.z * axis.x - axis.y * s,\r\n              oc * axis.y * axis.z + axis.x * s, oc * axis.z * axis.z + c);\r\n}\n\nvoid main() {\r\n  vec3 textureA = rotationMatrix3(vec3(10., 6., 3.), sin(uTime) * .1) *\r\n                  texture2D(uTextureA, vUv).xyz;\r\n  \n\n  vec3 textureB = rotationMatrix3(vec3(10., 6., 3.), sin(uTime) * .1) *\r\n                  texture2D(uTextureB, vUv).xyz;\r\n  \n\n  float t = uScroll;\r\n  vec3 pos = mix(textureA, textureB, t);\n\n  gl_FragColor = vec4(pos, 1.);\r\n}"}),a=new i;return a.setAttribute("position",new l(new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,-1,0,1,1,0,-1,1,0]),3)),a.setAttribute("uv",new l(new Float32Array([0,1,1,1,1,0,0,1,1,0,0,0]),2)),new u(a,e)};const $=["object"],ee=D({__name:"particalMesh",props:{progress:{default:0},width:{default:256},height:{default:256}},setup(e,{expose:a}){const t=e;let r=((e,a)=>{const t=e*a;let r=new Float32Array(3*t);for(let s=0;s<t;s++){let t=3*s;r[t+0]=s%e/e,r[t+1]=s/e/a}const o=new i;return o.setAttribute("position",new l(r,3)),new m(o,new c({uniforms:{uPositions:{value:null},uSize:{value:12},uPixelRatio:{value:Math.min(window.devicePixelRatio,2)},uColor:{value:new d("#ffaa00")}},vertexShader:"uniform sampler2D\r\n    uPositions; \nuniform float uSize;\r\nuniform float uPixelRatio;\r\nvarying vec3 vPos;\r\nvarying vec2 vUv;\r\nvoid main() {\r\n  vec3 pos = texture2D(uPositions, position.xy).xyz;\n\n  float customSize = uSize;\n\n  vec4 modelPosition = modelMatrix * vec4(pos, 1.0);\r\n  vec4 viewPosition = viewMatrix * modelPosition;\r\n  vec4 projectionPosition = projectionMatrix * viewPosition;\n\n  gl_Position = projectionPosition;\r\n  gl_PointSize = customSize * uPixelRatio;\r\n  gl_PointSize *= (1.0 / -viewPosition.z);\n\n  vPos = pos;\r\n}",fragmentShader:"precision mediump float;\r\nvarying vec3 vPos;\r\nuniform vec3 uColor; \nvoid main() {\n\n  float distanceToCenter = distance(gl_PointCoord, vec2(0.5));\r\n  float strength = 0.05 / distanceToCenter - 0.1;\n\n  \n\n  gl_FragColor = vec4(uColor, strength * length(vPos));\r\n}",transparent:!0,depthWrite:!1,blending:p}))})(t.width,t.height);return a({particles:r}),(e,a)=>(U(),R("primitive",{object:k(r)},null,8,$))}}),ae=D({__name:"particalFBO",props:{progress:{default:0},width:{default:256},height:{default:256},color:{default:"#ffaa00"}},async setup(e){let a,t;const r=e,o=I(null),i=new v(r.width,r.height,{minFilter:x,magFilter:x,generateMipmaps:!1,colorSpace:f,depthBuffer:!1,stencilBuffer:!1,format:s,type:n}),l=e=>{const a=[];return e.traverse(e=>{e instanceof u&&(e.geometry.deleteAttribute("uv"),e.geometry.deleteAttribute("normal"),e.geometry.deleteAttribute("tangent"),a.push(e.geometry))}),w(a)},c="https://opensource.cdn.icegl.cn",m=c+"/model/medical/brainparts.OBJ",p=new g,d=([a,t]=q(()=>F(m,p)),a=await a,t(),a),P=l(d);P.scale(.01,.01,.01);const b=Q(P),_=I(null),M=I(null),z=c+"/model/eCommerce/guanYu.glb",{state:S,nodes:T,materials:D,animations:R}=A(z,{draco:!0,decoderPath:"./draco/"});L(()=>S.value,e=>{if(e?.scene)try{const a=e.scene||e?.scene||e.scene,t=a.children?.[0]??a,r=l(t);r.rotateX(Math.PI/2),r.translate(0,-.9,0),_.value=Q(r)}catch(a){console.warn("guanyu merge error",a)}},{immediate:!0});const k=c+"/model/industry4/modelDraco.glb",{state:V,nodes:G,materials:O,animations:Y}=A(k,{draco:!0,decoderPath:"./draco/"});L(()=>V.value,e=>{if(e?.scene)try{const a=e.scene||e,t=a.children?.[0]??a,r=l(t);r.rotateX(-Math.PI/2),r.rotateY(Math.PI/3),r.translate(0,0,0),M.value=Q(r)}catch(a){console.warn("plane merge error",a)}},{immediate:!0});const N=Z(),X=new h,E=new y(-1,1,1,-1,1/Math.pow(2,53),1);X.add(N);const{onBeforeRender:W}=B(),{camera:H,renderer:K}=C();return W(({elapsed:e})=>{if(K&&H.value&&o.value){K.setRenderTarget(i),K.clear(),K.render(X,E),K.setRenderTarget(null);const a=_.value||null,t=b||null,s=M.value||null,n=j.clamp(-r.progress/2,0,1);if(n<.5?(N.material.uniforms.uTextureA.value=a??t,N.material.uniforms.uTextureB.value=t,N.material.uniforms.uScroll.value=2*n):(N.material.uniforms.uTextureA.value=t,N.material.uniforms.uTextureB.value=s??t,N.material.uniforms.uScroll.value=2*(n-.5)),N.material.uniforms.uTime.value=e,o.value?.particles?.material?.uniforms){o.value.particles.material.uniforms.uPositions.value=i.texture;const e=o.value.particles.material.uniforms.uColor;e&&e.value.setStyle(r.color)}}}),(e,a)=>(U(),J(ee,{ref_key:"pMesh",ref:o,progress:e.progress},null,8,["progress"]))}}),te=D({__name:"particalPass",props:{use:{type:Boolean,default:!0}},setup(e){const a=e,{camera:t,renderer:r,scene:o,sizes:n}=C(),i=0,l=.472,u=1.61;let c=null;V(()=>{n.width.value&&((e,a,t,r,o)=>{const n=new P(e,a),m=new b(new _(r,o),l,u,i),p=new v(r,o,{generateMipmaps:!1,minFilter:M,magFilter:M,format:s,colorSpace:f,samples:0});c=new z(t,p),c.addPass(n),c.addPass(m)})(o.value,t.value,r,n.width.value,n.height.value)});const{onRender:m}=B();return m(()=>{a.use?c&&c.render():r&&t.value&&r.render(o.value,t.value)}),(e,a)=>null}}),re=e(D({__name:"scrollPartical",setup(e){const o=I(0);V(()=>{console.log("jaime ~ progress:",o.value)});const s={clearColor:"#000",outputColorSpace:T,toneMapping:S,toneMappingExposure:1,windowSize:!0,renderMode:"manual",powerPreference:"high-performance",antialias:!0,alpha:!1,useLegacyLights:!1,physicallyCorrectLights:!0},n=G({pass:!0,color:"#6aff00"}),i=new r({title:"参数",expanded:!0});return i.addBinding(n,"pass",{label:"后处理"}),i.addBinding(n,"color",{label:"颜色"}),(e,r)=>{const i=O("TresCanvas");return U(),R(K,null,[Y(k(a),{styleNum:4}),Y(i,W(H(s)),{default:X(()=>[r[1]||(r[1]=N("TresPerspectiveCamera",{position:[0,0,-4],fov:45,near:.1,far:1e3,"look-at":[0,0,0]},null,-1)),Y(te,{use:n.pass},null,8,["use"]),Y(t,{modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=e=>o.value=e),distance:10,"smooth-scroll":.1,htmlScroll:""},{default:X(()=>[(U(),J(E,null,{default:X(()=>[Y(ae,{progress:o.value,color:n.color},null,8,["progress","color"])]),_:1}))]),_:1},8,["modelValue"])]),_:1},16),r[2]||(r[2]=N("main",null,[N("section",null,[N("h1",null,"关羽 - GuanYu")]),N("section",null,[N("h1",{style:{"margin-left":"-11em","margin-bottom":"-10em"}},"大脑 - Brain")]),N("section",null,[N("h1",{style:{"margin-left":"11em","margin-bottom":"-10em"}},"设备 - Device")])],-1))],64)}}}),[["__scopeId","data-v-156ee227"]]);export{re as default};
