import{i as e,r,d as t}from"./ice-utils.DHSeSyjo1764683399638.js";import{d as a,q as n,G as i,o as E}from"./@vue.DjQnunkc1764683399638.js";import{c as T,p as o,r as _,l as R,m as A}from"./gl-matrix.XZzMrBim1764683399638.js";const u={id:"canvaswebgl",style:{height:"500px",width:"500px"}},c=a({__name:"webglFrameBuffer",setup(a){const c=function(){const a=document.querySelector("#canvaswebgl"),n=a?.getContext("webgl");if(!n)return;var i=e(n,"\nattribute vec4 a_position;\nattribute vec2 a_texcoord;\nuniform mat4 u_matrix;\nvarying vec2 v_texcoord;\nvoid main() {\n  gl_Position = u_matrix * a_position;\n  v_texcoord = a_texcoord;\n}","\nprecision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D u_texture;\nvoid main(){\n\tgl_FragColor=texture2D(u_texture, v_texcoord.xy);\n}\n"),E=n.getAttribLocation(i,"a_position"),u=n.getAttribLocation(i,"a_texcoord"),c=n.getUniformLocation(i,"u_matrix"),F=n.getUniformLocation(i,"u_texture"),f=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,f),function(e){var r=new Float32Array([-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5]);e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW)}(n);var m=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,m),function(e){e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,0,1,0,0,1,1,1]),e.STATIC_DRAW)}(n);var s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s);{const e=0,r=n.RGBA,t=1,a=1,i=0,E=n.RGBA,T=n.UNSIGNED_BYTE,o=new Uint8Array([255,255,0,255]),_=1;n.pixelStorei(n.UNPACK_ALIGNMENT,_),n.texImage2D(n.TEXTURE_2D,e,r,t,a,i,E,T,o),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)}const x=n.createTexture();n.bindTexture(n.TEXTURE_2D,x);{const e=0,r=n.RGBA,t=0,a=n.RGBA,i=n.UNSIGNED_BYTE,E=null;n.texImage2D(n.TEXTURE_2D,e,r,256,256,t,a,i,E),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)}const U=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,U);const l=n.COLOR_ATTACHMENT0;n.framebufferTexture2D(n.FRAMEBUFFER,l,n.TEXTURE_2D,x,0);var v=t(0),b=0;function D(e){n.useProgram(i),n.enableVertexAttribArray(E),n.bindBuffer(n.ARRAY_BUFFER,f);var r=3,t=n.FLOAT,a=!1,s=0,x=0;n.vertexAttribPointer(E,r,t,a,s,x),n.enableVertexAttribArray(u),n.bindBuffer(n.ARRAY_BUFFER,m);r=2,t=n.FLOAT,a=!1,s=0,x=0;n.vertexAttribPointer(u,r,t,a,s,x);var U=T();o(U,-30,e,.1,1e4);let l=T();l=_(l,l,v,[0,1,0]);var b=T();R(b,[0,0,2],[0,0,0],[0,1,0]);let D=T();A(D,b,l);var B=T();A(B,U,D),n.uniformMatrix4fv(c,!1,B),n.uniform1i(F,0),n.drawArrays(n.TRIANGLES,0,36)}requestAnimationFrame(function e(t){var a=(t*=.001)-b;b=t,v+=-.4*a,r(n.canvas),n.enable(n.CULL_FACE),n.enable(n.DEPTH_TEST);n.bindFramebuffer(n.FRAMEBUFFER,U),n.bindTexture(n.TEXTURE_2D,s),n.viewport(0,0,256,256),n.clearColor(0,1,0,1),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT);D(1);n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindTexture(n.TEXTURE_2D,x),n.viewport(0,0,n.canvas.width,n.canvas.height),n.clearColor(1,1,1,1),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT);D(n.canvas.clientWidth/n.canvas.clientHeight);requestAnimationFrame(e)})};return n(()=>{c()}),(e,r)=>(E(),i("canvas",u))}});export{c as default};
