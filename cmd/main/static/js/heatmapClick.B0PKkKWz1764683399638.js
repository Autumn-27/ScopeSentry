import{K as t}from"./@tresjs.CJvYCGUA1764683399638.js";import{P as e}from"./tweakpane.CqZAnw7f1764683399638.js";import{z as a,q as s,a6 as o,j as i,$ as r,A as n}from"./three.BbguFgn81764683399638.js";import"./index.DM693cYN1764683399638.js";import{u as p}from"./index.DgwPK7tT1764683399638.js";import{h as l}from"./heatmap.js-fix.CVXWBZXX1764683399638.js";import{d as m,ad as u,a3 as d,G as c,o as h,ae as j,u as v,r as f,b as g,e as y,f as b,I as x,h as w,ah as _,a9 as C,aa as k,m as z}from"./@vue.DjQnunkc1764683399638.js";import"./postprocessing.DjqPXL_K1764683399638.js";import"./@vueuse.BBrxj3Xz1764683399638.js";import"./@fesjs.CQdxRiFD1764683399638.js";import"./vue-router.CW9J5iK31764683399638.js";import"./lodash-es.DWe8oqPO1764683399638.js";import"./pinia.yp40krTn1764683399638.js";import"./@qlin.y-0Z8WnK1764683399638.js";import"./@babel.BPq7uOAK1764683399638.js";import"./@floating-ui.Bhq4ibgf1764683399638.js";import"./@juggle.Vc7cP4_P1764683399638.js";import"./chalk.BHLFMujs1764683399638.js";/* empty css                                 */import"./iconify-icon.Dg3Wmqac1764683399638.js";import"./@iconify.Db0UMRdG1764683399638.js";import"./vite-plugin-qiankun.B06WoCqG1764683399638.js";import"./dompurify.C4MEnGDh1764683399638.js";import"./color.D_UQSrzA1764683399638.js";import"./color-string.cWrXb_cU1764683399638.js";import"./color-name.gyPnsvCn1764683399638.js";import"./lodash.OvYRBTRe1764683399638.js";import"./@amap.fjyZdsU91764683399638.js";import"./object-hash.C0HZ2EUZ1764683399638.js";import"./jszip.CqykFGTv1764683399638.js";import"./oimophysics.CfVKSiAm1764683399638.js";import"./three-stdlib.CqpxBIJB1764683399638.js";import"./@pmndrs.CRF-_adI1764683399638.js";import"./axios.Bl1IyXmH1764683399638.js";import"./useLoader.VuwfYjb91764683399638.js";const B=["object"],M=m({__name:"heatmapClickCom",props:{show2dCanvas:{type:Boolean,default:!0},radius:{default:20}},async setup(t){let e,r;const n=t,{nodes:m}=([e,r]=u(()=>p("https://opensource.cdn.icegl.cn/model/heatmap/test.glb")),e=await e,r(),e);m.mesh_0.position.set(-5088.96,-3.08,39374.7),m.mesh_0.scale.setScalar(.01);let f=null,g=null,y=null;g=new a((y=document.createElement("heatmap-canvas"),y.style.position="absolute",y.style.top="40px",y.style.left="0",document.body.appendChild(y),f=l.create({container:y,width:256,height:256,blur:"0.8",radius:n.radius}),f._renderer.canvas.style.border="1px solid #5384ff",f._renderer.canvas.onclick=function(t){f.addData({x:t.layerX,y:t.layerY,value:1,radius:n.radius}),f.setDataMax(1),g&&(g.needsUpdate=!0)},f)._renderer.canvas);const b=new s({vertexShader:"\n\tvarying vec2 vUv;\n\tvoid main() {\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\tvUv = uv;\n\t}\n\t",fragmentShader:"\n\tuniform sampler2D heightMap;\n\tuniform float uOpacity;\n\tvarying vec2 vUv;\n\tvoid main() {\n\t\tgl_FragColor = vec4(texture2D(heightMap, vUv.xy).rgb, uOpacity);\n\t}\n\t",uniforms:{uOpacity:{value:1},heightMap:{type:"t",value:g}},depthWrite:!0,depthTest:!0,transparent:!0,side:o});m.mesh_0.material=b;return(t=>{t.computeBoundingBox();const{max:e,min:a}=t.boundingBox;t.deleteAttribute("uv");const s=e.x-a.x,o=e.z-a.z,r=[];for(let i=0;i<t.attributes.position.count;i++)r.push((t.attributes.position.getX(i)-a.x)/s),r.push((t.attributes.position.getZ(i)-a.z)/o);const n=new Float32Array(r);t.setAttribute("uv",new i(n,2))})(m.mesh_0.geometry),d(()=>{y.style.display=""+(n.show2dCanvas?"block":"none")}),(t,e)=>(h(),c("primitive",{object:j(v(m).mesh_0)},null,8,B))}}),A=m({__name:"heatmapClick",setup(a){const s={clearColor:"#030311",shadows:!0,alpha:!0,outputColorSpace:n,shadowMapType:r,useLegacyLights:!0,antialias:!0},o=f({show2dCanvas:!0,radius:20}),i=new e({title:"参数",expanded:!0});return i.addBinding(o,"show2dCanvas",{label:"显示二维图"}),i.addBinding(o,"radius",{label:"圆圈的大小",min:.1,max:30,step:.1}),i.addButton({title:"点击左侧蓝色画框"}),(e,a)=>{const i=g("TresCanvas");return h(),y(i,z(s,{"window-size":""}),{default:b(()=>[a[0]||(a[0]=x("TresPerspectiveCamera",{position:[21,34,55],fov:60,near:1,far:1e5},null,-1)),w(v(t),{autoRotate:!1,autoRotateSpeed:2}),a[1]||(a[1]=x("TresDirectionalLight",{position:[5,10,7.5],color:"#ffffff",intensity:5},null,-1)),a[2]||(a[2]=x("TresGridHelper",{args:[50,25]},null,-1)),(h(),y(_,null,{default:b(()=>[w(M,C(k(o)),null,16)]),_:1}))]),_:1},16)}}});export{A as default};
