import{cW as e,cX as a,cY as t,cZ as n,c_ as o,c$ as d,d0 as s,d1 as l,z as r,d2 as i,d3 as c,bJ as p,bd as N,c0 as h,a6 as u,bj as m,aV as b,cp as g,cn as T,cm as M,co as v,cl as w,cq as f,cr as y,cs as S}from"./three.BbguFgn81764683399638.js";const D=((e="MeshBasicNodeMaterial")=>({template:e,Preview:"2d",surfaceType:"Transparent",blendingMode:"NormalBlending",renderFace:"FrontSide",depthWrite:"enable",depthTest:"enable",depthTestFunc:"LessEqualDepth",castShadows:!0}))(),E={lit:d,unlit:d,subgraph:d,MeshBasicNodeMaterial:d,MeshStandardNodeMaterial:o,MeshPhongNodeMaterial:n,MeshPhysicalNodeMaterial:t,LineDashedNodeMaterial:a,SpriteNodeMaterial:e},B={NoBlending:h,NormalBlending:N,AdditiveBlending:p,SubtractiveBlending:c,MultiplyBlending:i},x={FrontSide:b,BackSide:m,DoubleSide:u},F={NeverDepth:S,AlwaysDepth:y,EqualDepth:f,LessDepth:w,LessEqualDepth:v,GreaterDepth:M,GreaterEqualDepth:T,NotEqualDepth:g},q=(e,a={},t={})=>{const n={},o=(e=>{const a=e.replace(/\r\n/g,"\n").match(/\/\/\/\/ view \/\/\/\/ (.*)\n/);return a?JSON.parse(a[1]):null})(e);o&&o.textures?.forEach(a=>{const n=a.binding.varName;if(!t?.[n]){const a=e.match(new RegExp(`//// ${n} //// (.*)\\n`))?.[1];a&&t&&(t[n]=(e=>{const a=new Image,t=new r(a);return a.onload=()=>{t.needsUpdate=!0},a.src=e,t})(a))}});const d=Object.assign({},D,o?.setting),i=new(0,E[d.template]),c={};if(((e,a)=>{e.transparent="Transparent"===a.surfaceType,"Transparent"===a.surfaceType?e.blending=B[a.blendingMode]||N:e.blending=N,e.side=x[a.renderFace]||b,e.depthWrite="enable"===a.depthWrite,e.depthTest="enable"===a.depthTest,e.depthFunc=F[a.depthTestFunc]||v})(i,d),e)try{new Function("material","default_uniforms","__textures__","uniforms","tsl","THREE",e)(n,a||{},t,c,s,l)}catch(p){throw new Error("Invalid TSL format: "+p)}return"Transparent"===d.surfaceType?void 0===n.opacityNode?i.colorNode=n.colorNode||null:(i.colorNode=n.colorNode?.xyz||null,i.opacityNode=n.opacityNode||null):i.colorNode=n.colorNode?.xyz||null,i.vertexNode=n.vertexNode||null,i.positionNode=n.positionNode||null,i.normalNode=n.normalNode||null,i.alphaTestNode=n.alphaTestNode||null,i.depthNode=n.depthNode||null,i.emissiveNode=n.emissiveNode||null,i.envNode=n.envNode||null,i.aoNode=n.aoNode||null,i.backdropNode=n.backdropNode||null,i.backdropAlphaNode=n.backdropAlphaNode||null,d.castShadows&&(i.castShadowNode=n.castShadowNode||null),i.needsUpdate=!0,{material:i,uniforms:c,settings:d}};export{q as t};
