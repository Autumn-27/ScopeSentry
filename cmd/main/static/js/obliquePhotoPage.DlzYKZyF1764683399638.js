import{F as e,_ as s,K as t}from"./@tresjs.CJvYCGUA1764683399638.js";import{P as i}from"./tweakpane.CqZAnw7f1764683399638.js";import{A as o}from"./3d-tiles-renderer.B7rFX2pg1764683399638.js";import{a as r,b as a,i as l}from"./utils.DJFfMxDw1764683399638.js";import{d as n,a as p,w as m,G as u,o as d,I as j,u as c,r as f,b as g,e as h,f as v,h as b,m as R}from"./@vue.DjQnunkc1764683399638.js";import{$ as w,a0 as x}from"./three.BbguFgn81764683399638.js";import"./postprocessing.DjqPXL_K1764683399638.js";import"./@vueuse.BBrxj3Xz1764683399638.js";import"./@tweenjs.C9YEcV0Y1764683399638.js";import"./utils.e6kO7tRf1764683399638.js";import"./@fesjs.CQdxRiFD1764683399638.js";import"./vue-router.CW9J5iK31764683399638.js";import"./lodash-es.DWe8oqPO1764683399638.js";import"./pinia.yp40krTn1764683399638.js";import"./@qlin.y-0Z8WnK1764683399638.js";import"./@babel.BPq7uOAK1764683399638.js";import"./@floating-ui.Bhq4ibgf1764683399638.js";import"./@juggle.Vc7cP4_P1764683399638.js";import"./index.DM693cYN1764683399638.js";import"./chalk.BHLFMujs1764683399638.js";/* empty css                                 */import"./iconify-icon.Dg3Wmqac1764683399638.js";import"./@iconify.Db0UMRdG1764683399638.js";import"./vite-plugin-qiankun.B06WoCqG1764683399638.js";import"./dompurify.C4MEnGDh1764683399638.js";import"./color.D_UQSrzA1764683399638.js";import"./color-string.cWrXb_cU1764683399638.js";import"./color-name.gyPnsvCn1764683399638.js";import"./lodash.OvYRBTRe1764683399638.js";import"./@amap.fjyZdsU91764683399638.js";import"./object-hash.C0HZ2EUZ1764683399638.js";import"./jszip.CqykFGTv1764683399638.js";import"./oimophysics.CfVKSiAm1764683399638.js";import"./three-stdlib.CqpxBIJB1764683399638.js";import"./@pmndrs.CRF-_adI1764683399638.js";import"./axios.Bl1IyXmH1764683399638.js";import"./useTexture.RJnyBWqC1764683399638.js";import"./three-mesh-bvh.DQHx4kOk1764683399638.js";import"./d3-geo.C51lZA-81764683399638.js";const y=["object"],T=n({__name:"obliquePhoto",props:{tilesUrl:{default:"./plugins/geokit/tiles/tileset.json"},isRotation:{type:Boolean,default:!1},isRranslation:{type:Boolean,default:!0}},setup(t,{expose:i}){const l=t,n=p(null),{camera:f,renderer:g,sizes:h}=e(),v=(e,s,t)=>{e.setCamera(s),e.setResolutionFromRenderer(s,t)},b=()=>{let e=new o(l.tilesUrl);return e.fetchOptions.mode="cors",e.addEventListener("load-tile-set",()=>{a(e,l.isRotation,l.isRranslation)}),e.addEventListener("dispose-model",({scene:e})=>{e.traverse(e=>{e.material&&e.material.dispose()})}),v(e,f.value,g),e};let R=b();m(()=>[l.isRotation,l.isRranslation],()=>{R.group&&r(R.group,l.isRotation,l.isRranslation)}),m(f,()=>{f.value&&v(R,f.value,g)},{immediate:!0});const{onBeforeRender:w}=s();return w(()=>{f.value&&h.width.value&&R.update&&(f.value.updateMatrixWorld(),R.update())}),m(()=>l.tilesUrl,e=>{e!==R.rootURL&&(R.dispose(),R=b())}),i({group:n,tilesGroup:R.group}),(e,s)=>(d(),u("TresGroup",{ref_key:"groupRef",ref:n},[j("primitive",{object:c(R).group},null,8,y)],512))}}),U=n({__name:"obliquePhotoPage",setup(e){const s={clearColor:"#201919",windowSize:!0,shadows:!0,toneMapping:x,toneMappingExposure:1,shadowMapType:w},o=f({tilesUrl:"https://opensource.cdn.icegl.cn/3Dtiles/simpleGIS/TilesetWithDiscreteLOD/tileset.json",isRotation:!0,isRranslation:!0}),r=p(o.tilesUrl),a=new i;a.addBinding(r,"value",{label:"tiles地址"});return a.addButton({title:"应用",label:"从url读取tiles"}).on("click",()=>{r.value!==o.tilesUrl&&(a.disabled=!0,l(r.value).then(e=>{e?o.tilesUrl=r.value:alert("这不是一个有效的3D Tiles地址"),a.disabled=!1}))}),a.addBinding(o,"isRotation",{label:"地心旋转"}),a.addBinding(o,"isRranslation",{label:"居中展示"}),(e,i)=>{const r=g("TresCanvas");return d(),h(r,R(s,{"window-size":""}),{default:v(()=>[i[0]||(i[0]=j("TresPerspectiveCamera",{position:[800,800,800],fov:60,near:1,far:2e4},null,-1)),b(c(t)),i[1]||(i[1]=j("TresAmbientLight",{intensity:1},null,-1)),i[2]||(i[2]=j("TresDirectionalLight",{position:[1,2,3],intensity:1.25},null,-1)),i[3]||(i[3]=j("TresAxesHelper",{args:[100]},null,-1)),b(T,R(o,{"rotation-x":o.isRotation?-Math.PI/2:0}),null,16,["rotation-x"])]),_:1},16)}}});export{U as default};
