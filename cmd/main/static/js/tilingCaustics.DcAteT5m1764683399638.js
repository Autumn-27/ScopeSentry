import{_ as e,K as n}from"./@tresjs.CJvYCGUA1764683399638.js";import{d as t,w as r,G as o,o as s,I as i,a9 as a,aa as l,r as d,b as p,e as u,f,h as c,u as v,m}from"./@vue.DjQnunkc1764683399638.js";import{k as g,a6 as b}from"./three.BbguFgn81764683399638.js";import{P as h}from"./tweakpane.CqZAnw7f1764683399638.js";import"./postprocessing.DjqPXL_K1764683399638.js";import"./@vueuse.BBrxj3Xz1764683399638.js";const x=["rotation-x"],y=t({__name:"tilingCaustics",props:{speed:{default:.478},backgroundColor:{},color:{default:"#fff"},flowSpeed:{default:{x:.01,y:.01}},brightness:{default:1.5}},setup(n){const t=n,d={uniforms:{resolution:{type:"v2",value:{x:1,y:1}},backgroundColor:{type:"c",value:new g(t.color)},color:{type:"c",value:new g("#fff")},speed:{type:"f",value:t.speed},flowSpeed:{type:"v2",value:t.flowSpeed},brightness:{type:"f",value:t.brightness},time:{type:"f",value:.1}},vertexShader:"varying vec2 vUv;\n\nvoid main(){\r\n\t\n\t\n\tvUv=uv;\r\n\t\r\n\t\n\t\n\tgl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);\r\n}",fragmentShader:"#define TAU 6.28318530718\r\n#define MAX_ITER 5\n\nuniform vec2 resolution;\r\nuniform vec3 backgroundColor;\r\nuniform vec3 color;\r\nuniform float speed;\r\nuniform vec2 flowSpeed;\r\nuniform float brightness;\r\nuniform float time;\n\nvarying vec2 vUv;\n\nvoid main(){\r\n\tvec2 uv=(vUv.xy+(time*flowSpeed))*resolution;\r\n\t\r\n\tvec2 p=mod(uv*TAU,TAU)-250.;\r\n\tvec2 i=vec2(p);\r\n\t\r\n\tfloat c=1.;\r\n\tfloat inten=.005;\r\n\t\r\n\tfor(int n=0;n<MAX_ITER;n++){\r\n\t\tfloat t=time*speed*(1.-(3.5/float(n+1)));\r\n\t\ti=p+vec2(cos(t-i.x)+sin(t+i.y),sin(t-i.y)+cos(t+i.x));\r\n\t\tc+=1./length(vec2(p.x/(sin(i.x+t)/inten),p.y/(cos(i.y+t)/inten)));\r\n\t}\r\n\t\r\n\tc/=float(MAX_ITER);\r\n\tc=1.17-pow(c,brightness);\r\n\t\r\n\tvec3 rgb=vec3(pow(abs(c),8.));\r\n\t\r\n\tgl_FragColor=vec4(rgb*color+backgroundColor,length(rgb)+.1);\r\n}",side:b,transparent:!0,depthWrite:!1,depthTest:!0},{onBeforeRender:p}=e();return p(({delta:e})=>{d.uniforms.time.value+=e}),r(()=>t,()=>{d.uniforms.speed.value=t.speed,d.uniforms.brightness.value=t.brightness,d.uniforms.backgroundColor.value=new g(t.color)},{deep:!0}),(e,n)=>(s(),o("TresMesh",{"rotation-x":-Math.PI/2,"position-y":1},[n[0]||(n[0]=i("TresPlaneGeometry",{args:[10,10]},null,-1)),i("TresShaderMaterial",a(l(d)),null,16)],8,x))}}),w=t({__name:"tilingCaustics",setup(e){const t={clearColor:"#222"},r=d({color:"#fff",speed:.1,brightness:1.5,flowSpeed:{x:.01,y:.01}}),o=new h({title:"参数",expanded:!0});return o.addBinding(r,"color",{label:"颜色"}),o.addBinding(r,"speed",{label:"速度",min:.1,max:1,step:.1}),o.addBinding(r,"brightness",{label:"亮度",min:.1,max:2,step:.1}),o.addBinding(r,"flowSpeed",{label:"流动速度",picker:"inline",expanded:!0,x:{min:.01,step:.02,max:.6,inverted:!0},y:{min:.01,step:.02,max:.6,inverted:!0}}),(e,o)=>{const d=p("TresCanvas");return s(),u(d,m(t,{"window-size":""}),{default:f(()=>[o[0]||(o[0]=i("TresPerspectiveCamera",{position:[10,10,10]},null,-1)),o[1]||(o[1]=i("TresAmbientLight",{intensity:1},null,-1)),c(v(n)),o[2]||(o[2]=i("TresGridHelper",{args:[10,10]},null,-1)),c(y,a(l({...r})),null,16)]),_:1},16)}}});export{w as default};
