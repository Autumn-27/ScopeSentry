import{d as e,j as t,i as o,o as s,cF as r,k as a,a6 as n}from"./three.BbguFgn81764683399638.js";import{r as i}from"./@fesjs.CQdxRiFD1764683399638.js";import"./index.DM693cYN1764683399638.js";import{u as p}from"./useTexture.RJnyBWqC1764683399638.js";import{c as u,d as c,a as m}from"./three-mesh-bvh.DQHx4kOk1764683399638.js";const l=(e,o=!1)=>{e.computeBoundingBox();const{max:s,min:r}=e.boundingBox;e.deleteAttribute("uv");const a=s.x-r.x,n=s.y-r.y,i=[];for(let t=0;t<e.attributes.position.count;t++)o?(i.push((e.attributes.position.getX(t)-(r.x+s.x)/2)/a),i.push((e.attributes.position.getY(t)-(r.y+s.y)/2)/n)):(i.push((e.attributes.position.getX(t)-r.x)/a),i.push((e.attributes.position.getY(t)-r.y)/n));const p=new Float32Array(i);e.setAttribute("uv",new t(p,2))},g=(e,t)=>new Promise((o,s)=>{i(e,{},{method:"get",mergeRequest:!0,responseType:"json"}).then(e=>{t&&o(e[t]),o(e.features)}).catch(e=>{console.error(e),s(e)})}),h=e=>{const t=(new THREE.Box3).setFromObject(e),o=new THREE.Vector3;t.getCenter(o),e.children.forEach(e=>{e.position.sub(o)}),e.position.copy(o.negate())},d=()=>{o.prototype.computeBoundsTree=u,o.prototype.disposeBoundsTree=c,s.prototype.raycast=m},f=async t=>{const o=await p(["./plugins/water/images/Water_1_M_Normal.jpg","./plugins/water/images/Water_2_M_Normal.jpg"]),s=t.geometry.clone();l(s),s.computeBoundsTree();const i=new r(s,{color:new a("#fff"),scale:20,flowDirection:new e(1,1),textureWidth:1024,textureHeight:1024,normalMap0:o[0],normalMap1:o[1]});return i.material.transparent=!0,i.material.depthWrite=!0,i.material.depthTest=!0,i.material.side=n,i.material.uniforms.config.value.w=20,i.material.uniforms.reflectivity.value=.46,i};function y(t){const o=[];for(let r=0;r<t.length;r++)o.push(new e(t[r].x,t[r].y));const s=new e;for(let e=0;e<o.length;e++)s.add(o[e]);s.divideScalar(o.length);for(let e=0;e<o.length;e++)o[e].sub(s);return{points:o,centerPoint:s}}export{h as a,y as g,d as i,g as l,l as r,f as s};
