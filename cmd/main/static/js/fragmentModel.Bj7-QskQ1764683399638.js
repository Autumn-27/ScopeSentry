import{_ as o,K as r}from"./@tresjs.CJvYCGUA1764683399638.js";import{V as a,j as e,k as t,o as n,cL as s,a0 as i}from"./three.BbguFgn81764683399638.js";import"./index.DM693cYN1764683399638.js";import{u as m}from"./utils.Dayf5snU1764683399638.js";import{u as l}from"./index.DgwPK7tT1764683399638.js";import{P as c}from"./tweakpane.CqZAnw7f1764683399638.js";import{d as p,ad as u,r as v,a as d,w as f,G as g,o as x,I as y,a9 as j,aa as b,u as w,b as h,e as C,f as z,h as P,ah as _}from"./@vue.DjQnunkc1764683399638.js";import"./postprocessing.DjqPXL_K1764683399638.js";import"./@vueuse.BBrxj3Xz1764683399638.js";import"./@fesjs.CQdxRiFD1764683399638.js";import"./vue-router.CW9J5iK31764683399638.js";import"./lodash-es.DWe8oqPO1764683399638.js";import"./pinia.yp40krTn1764683399638.js";import"./@qlin.y-0Z8WnK1764683399638.js";import"./@babel.BPq7uOAK1764683399638.js";import"./@floating-ui.Bhq4ibgf1764683399638.js";import"./@juggle.Vc7cP4_P1764683399638.js";import"./chalk.BHLFMujs1764683399638.js";/* empty css                                 */import"./iconify-icon.Dg3Wmqac1764683399638.js";import"./@iconify.Db0UMRdG1764683399638.js";import"./vite-plugin-qiankun.B06WoCqG1764683399638.js";import"./dompurify.C4MEnGDh1764683399638.js";import"./color.D_UQSrzA1764683399638.js";import"./color-string.cWrXb_cU1764683399638.js";import"./color-name.gyPnsvCn1764683399638.js";import"./lodash.OvYRBTRe1764683399638.js";import"./@amap.fjyZdsU91764683399638.js";import"./object-hash.C0HZ2EUZ1764683399638.js";import"./jszip.CqykFGTv1764683399638.js";import"./oimophysics.CfVKSiAm1764683399638.js";import"./three-stdlib.CqpxBIJB1764683399638.js";import"./@pmndrs.CRF-_adI1764683399638.js";import"./axios.Bl1IyXmH1764683399638.js";import"./useLoader.VuwfYjb91764683399638.js";const A=["geometry"],M=p({__name:"fragmentModelCom",async setup(r){let i,p;const h=o=>{const r=[];return o.traverse(o=>{o instanceof n&&(o.geometry.deleteAttribute("uv"),o.geometry.deleteAttribute("tangent"),r.push(o.geometry))}),s(r)},C=h(([i,p]=u(()=>l("https://opensource.cdn.icegl.cn/model/eCommerce/guanYu.glb")),i=await i,p(),i).scene.children[0]);C.rotateX(Math.PI/2),C.translate(0,-.9,0);const z=C.clone().toNonIndexed(),P=h(([i,p]=u(()=>l("https://opensource.cdn.icegl.cn/model/industry4/modelDraco.glb")),i=await i,p(),i).scene.children[0]);P.rotateX(-Math.PI/2),P.rotateY(Math.PI/3);const _=P.clone().toNonIndexed(),M=z.attributes.position.array,D=z.attributes.position.count,N=_.attributes.position.array,I=_.attributes.normal.array,V=_.attributes.position.count,R=new Float32Array(D),k=new Float32Array(3*(D+2)),B=new Float32Array(3*(D+2)),F=new Float32Array(3*(D+2));for(let o=0;o<D;o+=3){const r=1*Math.random(),e=o%V;R[o]=r,R[o+1]=r,R[o+2]=r;const t=3*o,n=M[t],s=M[t+1],i=M[t+2],m=M[t+3],l=M[t+4],c=M[t+5],p=M[t+6],u=M[t+7],v=M[t+8],d=new a(n+m+p,s+l+u,i+c+v).divideScalar(3);k.set([d.x,d.y,d.z],3*o),k.set([d.x,d.y,d.z],3*(o+1)),k.set([d.x,d.y,d.z],3*(o+2));const f=(o,r,a)=>{const e=3*a;for(let t=0;t<3;t++){const n=e+3*t;r.set([o[n],o[n+1],o[n+2]],3*(a+t))}};f(N,B,e),f(I,F,e)}z.setAttribute("aRandom",new e(R,1)),z.setAttribute("aCenter",new e(k,3)),z.setAttribute("toPosition",new e(B,3)),z.setAttribute("toNormal",new e(F,3)),console.log(z.attributes);const S=([i,p]=u(()=>m("./plugins/visualArts/image/fragment512px.png")),i=await i,p(),i),T={uniforms:{u_progress:{value:-.1},matcap1:{value:S},m1Color:{type:"v3",value:new t("#ffc0fa")},matcap2:{value:S},m2Color:{type:"v3",value:new t("#bcd4ff")}},vertexShader:"varying vec2 vUv;\r\nvarying vec3 vNormal;\r\nvarying vec3 vViewPosition;\n\nattribute vec3 aCenter;\r\nattribute vec3 toPosition;\r\nattribute vec3 toNormal;\r\nattribute float aRandom;\n\nuniform float u_progress;\n\n#include <common>\n\nmat4 rotation3d(vec3 axis, float angle) {\r\n  axis = normalize(axis);\r\n  float s = sin(angle);\r\n  float c = cos(angle);\r\n  float oc = 1.0 - c;\n\n  return mat4(\r\n      oc * axis.x * axis.x + c, oc * axis.x * axis.y - axis.z * s,\r\n      oc * axis.z * axis.x + axis.y * s, 0.0, oc * axis.x * axis.y + axis.z * s,\r\n      oc * axis.y * axis.y + c, oc * axis.y * axis.z - axis.x * s, 0.0,\r\n      oc * axis.z * axis.x - axis.y * s, oc * axis.y * axis.z + axis.x * s,\r\n      oc * axis.z * axis.z + c, 0.0, 0.0, 0.0, 0.0, 1.0);\r\n}\n\nvoid main() {\r\n  vUv = uv;\n\n  float progress = u_progress;\r\n  float sinProgress = sin(progress * PI);\n\n  vec3 pos = mix(position, toPosition, progress);\r\n  vec3 nor = mix(normal, toNormal, progress);\n\n  vNormal = normalMatrix * normalize(nor);\n\n  float prog = ((pos.y + 1.) / 2.) * 1.1;\n\n  float locprog = clamp((sinProgress - 0.9 * prog) / 0.2, 0., 1.);\n\n  vec3 transform = pos - aCenter;\n\n  transform += 3. * aRandom * nor * locprog;\n\n  transform *= (1.0 - locprog);\n\n  transform += aCenter;\n\n  mat4 rotation = rotation3d(vec3(0., 1., 0.), aRandom * (locprog)*PI * 3.);\n\n  transform = (rotation * vec4(transform, 1.)).xyz;\n\n  vec4 modelViewPosition = modelViewMatrix * vec4(transform, 1.0);\n\n  gl_Position = projectionMatrix * modelViewPosition;\n\n  vViewPosition = -modelViewPosition.xyz;\r\n}",fragmentShader:"varying vec3 vNormal;\r\nvarying vec2 vUv;\r\nvarying vec3 vViewPosition;\r\nuniform sampler2D matcap;\r\nuniform sampler2D matcap2;\r\nuniform float u_progress;\r\nuniform vec3 m1Color;\r\nuniform vec3 m2Color;\n\nvoid main() {\r\n  vec3 viewDir = normalize(vViewPosition);\r\n  vec3 x = normalize(vec3(viewDir.z, 0.0, -viewDir.x));\r\n  vec3 y = cross(viewDir, x);\r\n  vec2 uv = vec2(dot(x, vNormal), dot(y, vNormal)) * 0.495 + 0.5;\n\n  float progress = abs(sin(u_progress));\n\n  vec3 matcapColor = texture2D(matcap, uv).rgb;\r\n  matcapColor = mix(matcapColor, m1Color, 0.5);\r\n  vec3 matcap2Color = texture2D(matcap2, uv).rgb;\r\n  matcap2Color = mix(matcap2Color, m2Color, 0.5);\n\n  vec3 color = vec3(matcapColor);\r\n  color = mix(color, matcap2Color, progress);\n\n  gl_FragColor = vec4(color, 1.0);\r\n}"},q=v({c1:"#ffc0fa",c2:"#bcd4ff"}),L=d(.5),U=new c({title:"参数"});return U.addBinding(T.uniforms.u_progress,"value",{label:"变化量",min:-.1,max:1,step:.001}).disabled=!0,U.addBinding(q,"c1",{label:"颜色1st"}),U.addBinding(q,"c2",{label:"颜色2rd"}),U.addBinding(L,"value",{label:"速度",min:.001,max:1,step:.001}),f(q,o=>{T.uniforms.m1Color.value.set(o.c1),T.uniforms.m2Color.value.set(o.c2)},{deep:!0}),o().onBeforeRender(({elapsed:o})=>{T.uniforms.u_progress.value=(Math.sin(o*L.value)+1)/2,U.refresh()}),(o,r)=>(x(),g("TresMesh",{geometry:w(z)},[y("TresShaderMaterial",j(b(T)),null,16)],8,A))}}),D=p({__name:"fragmentModel",setup(o){const a=v({enableDamping:!0,enableZoom:!0,autoRotate:!0,enablePan:!0,enableRotate:!0}),e={clearColor:"#000000",windowSize:!0,toneMapping:i,toneMappingExposure:.8};return(o,t)=>{const n=h("TresCanvas");return x(),C(n,j(b(e)),{default:z(()=>[t[0]||(t[0]=y("TresPerspectiveCamera",{position:[0,2,8],fov:45,near:.1,far:1e3},null,-1)),P(w(r),j(b(a)),null,16),t[1]||(t[1]=y("TresAmbientLight",{intensity:2},null,-1)),(x(),C(_,null,{default:z(()=>[P(M)]),_:1}))]),_:1},16)}}});export{D as default};
