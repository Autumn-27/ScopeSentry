import{ad as a,A as e,d7 as t,aa as l,du as n,d as o,aE as s,V as i}from"./three.BbguFgn81764683399638.js";import{T as u,G as r,H as c,_ as p,l as d,B as g,c as h,$ as v,b as f,J as m}from"./@icegl.eCZDSHLk1764683399638.js";import{s as b}from"./@tresjs.CJvYCGUA1764683399638.js";import{_}from"./DevTDTTiles.vue_vue_type_script_setup_true_lang.BvRObt5e1764683399638.js";import{d as w,r as j,a as M,w as k,b as y,G as x,o as C,h as T,I as P,f as z,e as S,H as I,u as q,ah as A,m as G,F as L}from"./@vue.DjQnunkc1764683399638.js";import{_ as D}from"./@fesjs.CQdxRiFD1764683399638.js";import"./postprocessing.DjqPXL_K1764683399638.js";import"./@vueuse.BBrxj3Xz1764683399638.js";import"./vue-router.CW9J5iK31764683399638.js";import"./lodash-es.DWe8oqPO1764683399638.js";import"./pinia.yp40krTn1764683399638.js";import"./@qlin.y-0Z8WnK1764683399638.js";import"./@babel.BPq7uOAK1764683399638.js";import"./@floating-ui.Bhq4ibgf1764683399638.js";import"./@juggle.Vc7cP4_P1764683399638.js";const E={scale:[5,5,5]},H=8e5,O=D(w({__name:"case-real-3",setup(w){const D=j({clearColor:"#201919",shadows:!0,alpha:!1,shadowMapType:t,outputColorSpace:e,toneMapping:a}),O=M({lon:117.84796240906425,lat:38.95216229684954,height:20}),U=M({lon:117.8533521756129,lat:38.95128,height:20});function B(a,e,t,l,n=!0){const o=e-a;return e=>{let s=(e-a)/o;return n&&(s=Math.max(0,Math.min(1,s))),t+s*(l-t)}}const F=M();const J=M(0),R=M(2e3),V=M(100),W=M(1),$=M(1),K=B(5e3,1e7,1,1e3),N=B(5e3,1e7,.001,1);k(J,a=>{R.value=2e3/K(a),V.value=100*K(a),W.value=N(a),$.value=(a-1e5)/9e5*.5});const Q=M(1),X=M({lon:90.85,lat:40,height:H});const Y=()=>{!function(){const a=performance.now()/1e3*Q.value%500/500*2*Math.PI;X.value.lon=(90.85+180*a/Math.PI)%360,X.value.lat=40+5*Math.cos(a),X.value.height=H}(),F.value&&(J.value=function(a){const e=a.x,t=a.y,l=a.z,n=6378137,o=6356752.314245,s=n*n,i=o*o,u=(s-i)/s,r=(s-i)/i,c=Math.hypot(e,t);if(0===c&&0===l)return Math.sqrt(e*e+t*t+l*l)-n;const p=Math.atan2(l*n,c*o),d=Math.sin(p),g=Math.cos(p),h=Math.atan2(l+r*o*d*d*d,c-u*n*g*g*g),v=Math.sin(h),f=Math.cos(h),m=n/Math.sqrt(1-u*v*v);return Math.abs(f)>1e-12?c/f-m:l/Math.sign(v)-m*(1-u)}(F.value?.getWorldPosition(new i)))},Z=M({effectProps:{enabled:!1,focusArea:.7,feather:.1},ambientLight:{color:"#fff",intensity:1},directionalLight:{color:"#fff",intensity:2,position:[-1500,500,500]},background:"/plugins/earthSample/image/menuA/bg-img.png"}),aa=M({heading:90,pitch:-60,distance:6e6,longitude:117.85013382539205,latitude:38.95151356092132}),ea=M({heading:90,pitch:45,distance:200}),ta=[{lon:117.85481967875631,lat:38.95025551631983},{lon:117.85566616248491,lat:38.95427209924625},{lon:117.85712202478027,lat:38.95970065499051},{lon:118.10293300958989,lat:38.92203696242356},{lon:118.21571040844162,lat:38.8584869570214},{lon:118.56457646308445,lat:38.792815766352845},{lon:119.52790645782477,lat:38.717044062084426},{lon:120.65902562748857,lat:38.60702467836941},{lon:120.79461456776448,lat:38.58622713855249},{lon:120.92076119840306,lat:38.52106665879057},{lon:121.9906916889725,lat:38.18314251246517},{lon:124.14446035378819,lat:37.44557549519065},{lon:125.9802772978905,lat:37.39012819157668},{lon:126.42446686403741,lat:37.35004753338622},{lon:126.48154639818023,lat:37.36107410768207},{lon:126.56124848326965,lat:37.40711309766567},{lon:126.57255884697423,lat:37.421008747816884},{lon:126.581932075672,lat:37.42778825439147},{lon:126.59275992012022,lat:37.42831387228446},{lon:126.60078120441494,lat:37.42464694776248}],la=new l;for(let a=0;a<ta.length-1;a++){const e=ta[a],t=ta[a+1];la.add(new n(new o(e.lon,e.lat),new o(t.lon,t.lat)))}const na=la.getSpacedPoints(1e3).map(a=>({lon:a.x,lat:a.y,height:20})),oa=M(!1),sa=M({heading:90,pitch:-60,distance:6e6,longitude:117.85013382539205,latitude:38.95151356092132});function ia(){aa.value={heading:0,pitch:-45,distance:1e5,longitude:X.value.lon,latitude:X.value.lat},oa.value=!0}function ua(){aa.value={heading:0,pitch:-45,distance:500,longitude:O.value.lon,latitude:O.value.lat},oa.value=!1}function ra(){aa.value={heading:0,pitch:-45,distance:500,longitude:U.value.lon,latitude:U.value.lat},oa.value=!1}function ca(){aa.value={...sa.value},oa.value=!1}return(a,e)=>{const t=y("TresCanvas");return C(),x(L,null,[T(t,G(D,{"window-size":"",onLoop:Y}),{default:z(()=>[P("TresPerspectiveCamera",{fov:45,near:.1,far:1e3,"look-at":[0,0,0],ref_key:"cameraRef",ref:F},null,512),T(q(u)),T(q(r),{position:aa.value,"onUpdate:position":e[0]||(e[0]=a=>aa.value=a),targetPosition:ea.value,"onUpdate:targetPosition":e[1]||(e[1]=a=>ea.value=a),target:oa.value?X.value:null,"min-distance":1},null,8,["position","targetPosition","target"]),T(q(c),{sceneConfig:Z.value},null,8,["sceneConfig"]),T(_,{layer:"img"}),T(q(p),{point:O.value},{default:z(()=>[T(q(d),{rotate:-12,"scale-x":.9},{default:z(()=>[T(q(g),{url:"/plugins/geokit/case-real-3/model/chuan.glb",draco:""})]),_:1})]),_:1},8,["point"]),T(q(p),{point:U.value},{default:z(()=>[T(q(d),{rotate:-12,"scale-x":.9},{default:z(()=>[T(q(g),{url:"/plugins/geokit/case-real-3/model/chuan.glb",draco:""})]),_:1})]),_:1},8,["point"]),(C(),S(A,null,{default:z(()=>[T(q(b),{path:"/plugins/geokit/case-real-3/image/road-texture.png"},{default:z(({state:a})=>[T(q(h),{texture:a,wrapT:q(s),wrapS:q(s)},null,8,["texture","wrapT","wrapS"]),q(na).length?(C(),S(q(v),{key:0,speed:W.value},{default:z(()=>[T(q(f),{repeat:[R.value,1],map:a,duration:4,points:q(na),width:V.value,color:"#fff",renderOrder:500},null,8,["repeat","map","points","width"])]),_:2},1032,["speed"])):I("",!0)]),_:1})]),_:1})),q(na).length?(C(),S(q(f),{key:0,points:q(na),width:V.value,color:"#fff",opacity:$.value,renderOrder:200},null,8,["points","width","opacity"])):I("",!0),T(q(p),{point:X.value},{default:z(()=>[T(q(d),{rotate:-12,"scale-x":.9},{default:z(()=>[P("TresGroup",E,[T(q(g),{url:"/plugins/geokit/case-real-3/model/weixing.glb",draco:""})])]),_:1})]),_:1},8,["point"]),T(q(m),{icon:"/plugins/geokit/case-real-3/icons/satellite.svg",size:16,point:X.value,onClick:e[2]||(e[2]=a=>oa.value=!oa.value)},null,8,["point"]),T(q(m),{icon:"/plugins/geokit/case-real-3/icons/ship.svg",size:16,point:O.value},null,8,["point"]),T(q(m),{icon:"/plugins/geokit/case-real-3/icons/ship.svg",size:16,point:U.value},null,8,["point"])]),_:1},16),P("div",{class:"control-panel"},[P("button",{onClick:ia,class:"focus-btn satellite-btn"}," 聚焦卫星 "),P("button",{onClick:ua,class:"focus-btn ship-btn"}," 聚焦船只1 "),P("button",{onClick:ra,class:"focus-btn ship-btn"}," 聚焦船只2 "),P("button",{onClick:ca,class:"reset-btn"}," 还原镜头 ")])],64)}}}),[["__scopeId","data-v-8574feed"]]);export{O as default};
