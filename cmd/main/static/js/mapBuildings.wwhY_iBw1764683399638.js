import{n as e,_ as o,F as t}from"./@tresjs.CJvYCGUA1764683399638.js";import{A as i}from"./3d-tiles-renderer.B7rFX2pg1764683399638.js";import{aE as s,V as a,bz as r,a6 as n,B as p,S as l,M as u,Q as m,ap as c,cO as d,cN as f,cP as g,k as _,c1 as h,dP as j,ad as y,A as w,d7 as v,g as x}from"./three.BbguFgn81764683399638.js";import{B as b}from"./three-custom-shader-material.VhylcSiy1764683399638.js";import{b as M,a as P}from"./buildingsShaderMaterial.B9_tL0mN1764683399638.js";import{d as z,w as B,ad as C,G as T,o as S,F as A,W as k,I as q,u as R,a as L,a3 as W,h as E,e as G,f as F,ah as H,t as I,r as Z,b as D,m as J}from"./@vue.DjQnunkc1764683399638.js";import{d as O,U as N,a as U,b as V,T as Q,c as X,r as Y}from"./raycasterEvent.CulMKG-f1764683399638.js";import"./Fetch.CIMEiaKn1764683399638.js";import"./@tweenjs.C9YEcV0Y1764683399638.js";import"./@fesjs.CQdxRiFD1764683399638.js";import"./index.DM693cYN1764683399638.js";import"./three-tile.nLdI1RRs1764683399638.js";/* empty css                                                                                    */import{_ as K,a as $}from"./radraB.vue_vue_type_script_setup_true_lang.ByFpUkdc1764683399638.js";import{_ as ee}from"./precipitation.vue_vue_type_script_setup_true_lang.BgegfjFx1764683399638.js";import{_ as oe}from"./cloudMesh.vue_vue_type_script_setup_true_lang.Bw58l1GG1764683399638.js";import{_ as te}from"./buildingsMarkA.vue_vue_type_script_setup_true_lang.BM0Y42iI1764683399638.js";import{_ as ie}from"./fireA.vue_vue_type_script_setup_true_lang.CMeeaxzL1764683399638.js";import{_ as se}from"./fireB.vue_vue_type_script_setup_true_lang.Mxbo5XoZ1764683399638.js";import{_ as ae}from"./smokeA.vue_vue_type_script_setup_true_lang.BtVNQJYA1764683399638.js";import{_ as re}from"./rippleMesh.vue_vue_type_script_setup_true_lang.ByF7_9M91764683399638.js";import{l as ne}from"./utils.e6kO7tRf1764683399638.js";import"./postprocessing.DjqPXL_K1764683399638.js";import"./@vueuse.BBrxj3Xz1764683399638.js";import"./@mapbox.DBNDgF_h1764683399638.js";import"./three-mesh-bvh.DQHx4kOk1764683399638.js";import"./vue-router.CW9J5iK31764683399638.js";import"./lodash-es.DWe8oqPO1764683399638.js";import"./pinia.yp40krTn1764683399638.js";import"./@qlin.y-0Z8WnK1764683399638.js";import"./@babel.BPq7uOAK1764683399638.js";import"./@floating-ui.Bhq4ibgf1764683399638.js";import"./@juggle.Vc7cP4_P1764683399638.js";import"./chalk.BHLFMujs1764683399638.js";/* empty css                                 */import"./iconify-icon.Dg3Wmqac1764683399638.js";import"./@iconify.Db0UMRdG1764683399638.js";import"./vite-plugin-qiankun.B06WoCqG1764683399638.js";import"./dompurify.C4MEnGDh1764683399638.js";import"./color.D_UQSrzA1764683399638.js";import"./color-string.cWrXb_cU1764683399638.js";import"./color-name.gyPnsvCn1764683399638.js";import"./lodash.OvYRBTRe1764683399638.js";import"./@amap.fjyZdsU91764683399638.js";import"./object-hash.C0HZ2EUZ1764683399638.js";import"./jszip.CqykFGTv1764683399638.js";import"./oimophysics.CfVKSiAm1764683399638.js";import"./three-stdlib.CqpxBIJB1764683399638.js";import"./@pmndrs.CRF-_adI1764683399638.js";import"./axios.Bl1IyXmH1764683399638.js";import"./SPE.vXfNhp2I1764683399638.js";import"./useTexture.RJnyBWqC1764683399638.js";const pe=["args"],le=["map","side","color"],ue=z({__name:"roadLightByLonLat",props:{geoJson:{},color:{default:"#ffff00"},radius:{default:2},speed:{default:1}},async setup(t){let i,p;const l=t,{state:u}=e("./plugins/digitalCity/image/line.png");B(u,e=>{e&&(e.needsUpdate=!0,e.wrapS=e.wrapT=s,e.repeat.set(1,1))});const m=([i,p]=C(()=>ne(l.geoJson)),i=await i,p(),i);let c=[];for(let e=0;e<m.length;e++){const o=m[e],t=[];o.geometry.coordinates.forEach(e=>{const o=O(e[0],e[1],50);t.push(new a(o[0],0,-o[1]))});let i=l.color;i="primary"===o.properties.highway?"#7eff10":"tertiary"===o.properties.highway?"#0eeeee":"secondary"===o.properties.highway?"#ffffff":"#ff0ffe",c.push({cr3:new r(t),color:i})}const{onBeforeRender:d}=o();return d(()=>{u.value&&(u.value.offset.x-=Math.random()/20*l.speed)}),(e,o)=>(S(),T("TresGroup",null,[(S(!0),T(A,null,k(R(c),(e,o)=>(S(),T("TresMesh",{key:o,renderOrder:3e3},[q("TresTubeGeometry",{args:[e.cr3,64,l.radius,20,!1]},null,8,pe),q("TresMeshBasicMaterial",{map:R(u),side:R(n),transparent:!0,color:e.color},null,8,le)]))),128))]))}}),me=e=>{e.onLoadTileSet=o=>{const t=new p,i=new l,s=new u;let r=null,n=0;e.getOrientedBounds(t,s)?(r=(new a).setFromMatrixPosition(s),n=r.length()):e.getBoundingSphere(i)&&(r=i.center.clone(),n=r.length());const c=r?.normalize(),d=((e,o)=>{const t=new m,i=(new a).crossVectors(e,o);return t.x=i.x,t.y=i.y,t.z=i.z,t.w=1+e.clone().dot(o),t.normalize(),t})(c,new a(0,1,0));e.group.quaternion.x=d.x,e.group.quaternion.y=d.y,e.group.quaternion.z=d.z,e.group.quaternion.w=d.w,e.group.position.z=-n}},ce=["object","rotation"],de=z({__name:"tilesBuildings",props:{bulidingsColor:{default:"#e523ff"},topColor:{default:"#ffff00"},opacity:{default:.8},gradient:{type:Boolean,default:!0},camera:{}},setup(e){const s=e,a=L(0),r=new i("https://jdvop.oss-cn-qingdao.aliyuncs.com/mapv-data/titleset/sz_ns/no.json");r.errorTarget=2,r.addEventListener("load-model",({scene:e})=>{e.traverse(e=>{if(e.isMesh){(e=>{const{geometry:o}=e;o.computeBoundingBox(),o.computeBoundingSphere();const{max:t,min:i}=o.boundingBox,r=new b({baseMaterial:new h,vertexShader:P,fragmentShader:M,silent:!0,uniforms:{uMax:{value:t},uMin:{value:i},uBorderWidth:{value:5},uCircleTime:{value:5},uColor:{value:new _(s.bulidingsColor)},uOpacity:{value:s.opacity},uLightColor:{value:new _("#ffffff")},uTopColor:{value:new _(s.topColor)},uTime:a,uGradient:{value:s.gradient}},depthWrite:!0,depthTest:!0,transparent:!0,side:n});e.material.dispose(),e.material=r})(e),e.receiveShadow=!1,e.castShadow=!1;const o=new c(e.geometry.clone());let t=(new d).fromEdgesGeometry(o),i=new f({color:0,linewidth:1,opacity:1,transparent:!0,depthWrite:!0,depthTest:!0});i.resolution.set(window.innerWidth,window.innerHeight);const r=new g(t,i);r.applyMatrix4(e.matrix.clone()),e.parent.add(r)}});const o=new p,t=new l;r.getBoundingBox(o)?(o.getCenter(r.group.position),r.group.position.multiplyScalar(-1)):r.getBoundingSphere(t)&&(r.group.position.copy(t.center),r.group.position.multiplyScalar(-1))}),me(r);const{renderer:u,sizes:m}=t();W(()=>{m.width.value&&(r.setCamera(s.camera),r.setResolutionFromRenderer(s.camera,u))});const{onBeforeRender:j}=o();return j(({delta:e})=>{a.value+=2*e,s.camera&&m.width.value&&(s.camera.updateMatrixWorld(),r.update())}),(e,o)=>(S(),T("TresGroup",null,[q("primitive",{object:R(r).group,rotation:[-Math.PI/2,0,0]},null,8,ce)]))}}),fe=["object","rotation"],ge=z({__name:"tileMapBuildingsMesh",props:{bbox:{default:[104.955976,20.149765,120.998419,30.528687]},maxZoom:{default:20},mapCenter:{},camera:{}},setup(e,{expose:i}){const s=e,{renderer:r,scene:n}=t(),p=new U;p.coordType=N;const l=new V;l.source="https://webrd04.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=7&x={x}&y={y}&z={z}",l.showTileNo=!1,l.useWorker=!0;const u=new Q(p,l);u.showBoundingBox=!1,u.wireframe=!1,u.flatShading=!1,u.filter={opposite:!0,genBright:1.3,genContrast:1,genSaturation:1};let m=new _("#4688b5");u.filter.monochrome={r:m.r,g:m.g,b:m.b};const c=new X;c.provider=u,c.bbox=s.bbox,c.maxZoom=s.maxZoom,s.camera.up=new a(0,1,0),s.camera.position.set(s.mapCenter[0],s.mapCenter[2],2e3-s.mapCenter[1]),s.camera.lookAt(new a(s.camera.position.x,0,s.camera.position.z-3e3)),c.camera=s.camera;let d=null;W(()=>{r&&(d=new j(s.camera,r.domElement),d.enableDamping=!0,d.dampingFactor=.05,d.minDistance=600,d.position0.set(s.camera.position.x,s.camera.position.y,s.camera.position.z),d.target.set(s.camera.position.x,0,s.camera.position.z-2e3))});const{onBeforeRender:f}=o();return f(()=>{if(r){const e=50*Math.abs(s.camera.position.y);s.camera.far=e+5e3,s.camera.updateProjectionMatrix(),d&&(d.update(),d.target.y=0),c.update(),r.render(n.value,s.camera)}}),i({camera:s.camera,map:c}),(e,o)=>(S(),T("primitive",{object:R(c),rotation:[-Math.PI/2,0,0]},null,8,fe))}}),_e=z({__name:"mapBuildingsMoreMeshes",props:{cPosition:{}},setup(e){const o=O(113.9456,22.5385,50),t=O(113.9498,22.5364,50);return(e,i)=>(S(),T(A,null,[E(R(K),{color:"#00c0ff",radius:300,size:300,position:[e.cPosition[0],8,-e.cPosition[1]]},null,8,["position"]),(S(),G(H,null,{default:F(()=>[E(R(te),{position:[e.cPosition[0],8,-e.cPosition[1]],scale:.13,img:"./plugins/digitalCity/image/znsba.png",foremost:!1},null,8,["position"])]),_:1})),E(R($),{position:[e.cPosition[0]+700,10,300-e.cPosition[1]],color:"#ffff00",height:180,maxRadius:400},null,8,["position"]),(S(),G(H,null,{default:F(()=>[E(R(te),{position:[e.cPosition[0]+700,10,300-e.cPosition[1]],scale:200,img:"./plugins/digitalCity/image/znsb-err.png",sizeAttenuation:!0,foremost:!0},null,8,["position"])]),_:1})),(S(),G(H,null,{default:F(()=>[E(R(ie),{fireScale:80,magnitude:1.3,lacunarity:2,gain:1,position:[e.cPosition[0]+280,1,120-e.cPosition[1]]},null,8,["position"])]),_:1})),(S(),G(H,null,{default:F(()=>[E(R(se),{position:[e.cPosition[0]+388,6,330-e.cPosition[1]]},null,8,["position"])]),_:1})),(S(),G(H,null,{default:F(()=>[E(R(ae),{position:[e.cPosition[0]+388,6,330-e.cPosition[1]]},null,8,["position"])]),_:1})),(S(),G(H,null,{default:F(()=>[E(R(ee),{speed:12,size:20,count:2e4,color:"#fff",type:"snow",position:[e.cPosition[0],300,-e.cPosition[1]],areaX:5e3,areaY:600,areaZ:5e3},null,8,["position"])]),_:1})),E(R(oe),{cPosition:[e.cPosition[0],600,-e.cPosition[1]]},null,8,["cPosition"]),E(R(re),{"position-y":6,positionSrc:[{x:R(o)[0],y:-R(o)[1]},{x:R(o)[0],y:-R(t)[1]},{x:R(t)[0],y:-R(t)[1]},{x:R(t)[0],y:-R(o)[1]},{x:R(o)[0],y:-R(o)[1]}],height:220,color:"#00ffdd"},null,8,["positionSrc"]),(S(),G(H,null,{default:F(()=>[E(R(ue),{position:[500,10,340],radius:5,geoJson:"plugins/digitalCity/geojson/shenzhen2.geojson"})]),_:1}))],64))}}),he=z({__name:"mapBuildings",setup(e){const o=O(113.942639739199,22.53171672540276,50),t=I(),i=Z({clearColor:"#000000",renderMode:"manual",alpha:!1,shadowMapType:v,outputColorSpace:w,toneMapping:y}),s=[o[0],o[1],1700],a=new x(60,window.innerWidth/window.innerHeight,1,1e8);return(e,r)=>{const n=D("TresCanvas");return S(),T(A,null,[E(n,J(i,{"window-size":""}),{default:F(()=>[r[0]||(r[0]=q("TresAmbientLight",{color:"#ffffff"},null,-1)),r[1]||(r[1]=q("TresDirectionalLight",{position:[100,100,0],intensity:.5,color:"#ffffff"},null,-1)),E(R(de),{position:[R(o)[0],1,228-R(o)[1]],camera:R(a)},null,8,["position","camera"]),(S(),G(H,null,{default:F(()=>[E(R(ge),{ref_key:"tileMapBuildingsMeshRef",ref:t,bbox:[104.955976,20.149765,120.998419,30.528687],mapCenter:s,camera:R(a)},null,8,["camera"])]),_:1})),(S(),G(H,null,{default:F(()=>[E(_e,{cPosition:R(o)},null,8,["cPosition"])]),_:1})),r[2]||(r[2]=q("TresGridHelper",{args:[1e4,10]},null,-1)),r[3]||(r[3]=q("TresAxesHelper",{args:[1e5]},null,-1))]),_:1},16),E(Y,{tileMapRef:t.value},null,8,["tileMapRef"])],64)}}});export{he as default};
