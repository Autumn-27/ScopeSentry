import{H as e,y as t,a0 as a,K as s}from"./@tresjs.CJvYCGUA1764683399638.js";import{A as o,d7 as l}from"./three.BbguFgn81764683399638.js";import{M as i}from"./mqttTvt.C87wZJbH1764683399638.js";import{d as r,a as n,q as u,V as m,i as p,w as c,G as d,o as v,h as j,u as f,f as b,v as g,I as h,ad as y,F as _,ae as w,b as O,e as T,ah as k,a9 as q,aa as x,E as A}from"./@vue.DjQnunkc1764683399638.js";import{u as M,b as S,f as P,i as F,k as I,N as D,h as N,l as $,m as z}from"./naive-ui.B3U9nW8I1764683399638.js";import"./index.DM693cYN1764683399638.js";import{u as C}from"./index.DgwPK7tT1764683399638.js";import"./postprocessing.DjqPXL_K1764683399638.js";import"./@vueuse.BBrxj3Xz1764683399638.js";import"./events.BU9utmI-1764683399638.js";import"./mqtt.rTqcrTe21764683399638.js";import"./date-fns.eh-WGDI81764683399638.js";import"./@css-render.xqIdICM01764683399638.js";import"./css-render.C5auSBy-1764683399638.js";import"./@emotion.DFFAhID71764683399638.js";import"./seemly.D2hUckm91764683399638.js";import"./vooks.Bo4F44h01764683399638.js";import"./evtd.C4K_ichY1764683399638.js";import"./vueuc.CRwbGw8l1764683399638.js";import"./vdirs.T0yx3CKS1764683399638.js";import"./@juggle.Vc7cP4_P1764683399638.js";import"./lodash-es.DWe8oqPO1764683399638.js";import"./treemate.Qc8YxXqZ1764683399638.js";import"./date-fns-tz.C_a0YZvl1764683399638.js";import"./async-validator.DJtlKCAR1764683399638.js";import"./@fesjs.CQdxRiFD1764683399638.js";import"./vue-router.CW9J5iK31764683399638.js";import"./pinia.yp40krTn1764683399638.js";import"./@qlin.y-0Z8WnK1764683399638.js";import"./@babel.BPq7uOAK1764683399638.js";import"./@floating-ui.Bhq4ibgf1764683399638.js";import"./chalk.BHLFMujs1764683399638.js";/* empty css                                 */import"./iconify-icon.Dg3Wmqac1764683399638.js";import"./@iconify.Db0UMRdG1764683399638.js";import"./vite-plugin-qiankun.B06WoCqG1764683399638.js";import"./dompurify.C4MEnGDh1764683399638.js";import"./color.D_UQSrzA1764683399638.js";import"./color-string.cWrXb_cU1764683399638.js";import"./color-name.gyPnsvCn1764683399638.js";import"./lodash.OvYRBTRe1764683399638.js";import"./@amap.fjyZdsU91764683399638.js";import"./object-hash.C0HZ2EUZ1764683399638.js";import"./jszip.CqykFGTv1764683399638.js";import"./oimophysics.CfVKSiAm1764683399638.js";import"./three-stdlib.CqpxBIJB1764683399638.js";import"./@pmndrs.CRF-_adI1764683399638.js";import"./axios.Bl1IyXmH1764683399638.js";import"./useLoader.VuwfYjb91764683399638.js";const L={class:"w-100 absolute z-99999 mqttdebugger",style:{"margin-top":"40px"}},Q=r({__name:"widthMqtt",setup(e){const t=M(),a=n(!1),s=n(!1),o={host:"a5183db3.ala.asia-southeast1.emqxsl.com",port:8084,protocol:"wss",clientId:`tvt-test-client-${Math.random().toString(16).slice(2,8)}`,username:"tvt.js",password:"test",topic:"tvtDevices/#"},l=n(null),r=n(!1),y=n([]);function _(){l.value&&w(),l.value=new i(o),l.value.on("connected",()=>{r.value=!0,console.log("MQTT 连接成功"),function(){if(!l.value)return;l.value.subscribe(o.topic,e=>{e?console.error(`订阅失败: ${e.message}`):console.log(`已订阅主题: ${o.topic}`)})}()}),l.value.on("close",()=>{r.value=!1,console.log("MQTT 连接关闭")}),l.value.on("error",e=>{console.error(`MQTT 错误: ${e.message}`)}),l.value.on("message",(e,o)=>{y.value.push(`[${e}] ${JSON.stringify(o)}`),y.value.length>100&&y.value.shift(),!s.value&&o&&o.status&&(a.value="运行"===o.status),o&&o.detail&&t.info("mqtt["+o.deviceId+"] 设备详情："+o.detail+"程序已运行："+o.uptime,{keepAliveOnHover:!0,duration:18e3})}),l.value.connect()}function w(){l.value&&(l.value.removeAllListeners(),l.value.disconnect(),l.value=null,r.value=!1)}u(()=>{_()}),m(()=>{l.value,w()});let O=null;function T(e){s.value=!0;const t={deviceId:"tvtDevice001",status:e?"运行":"关闭"};l.value.publish("tvtDevices/tvtDevice001/control",t),clearTimeout(O),O=setTimeout(()=>{s.value=!1},1e3)}const k=p("animationPlay");return c(()=>a.value,e=>{k.value=e},{immediate:!0}),(e,t)=>(v(),d("div",L,[j(f(S),{title:"MQTT 调试面板",style:{"background-color":"#d6d0c540"}},{default:b(()=>[j(f(P),{label:"注意："},{default:b(()=>[j(f(F),{style:{padding:"30px 21px","line-height":"21px"},type:"warning"},{default:b(()=>[...t[1]||(t[1]=[g("免费服务每月流量/次数有限",-1),h("br",null,null,-1),g("若连接失败请自行更换自己的mqtt服务",-1)])]),_:1})]),_:1}),j(f(I),{style:{"margin-top":"-10px"}},{default:b(()=>[...t[2]||(t[2]=[g("mqtt配置信息",-1)])]),_:1}),j(f(D),{value:JSON.stringify(o,null,2),type:"textarea",rows:9,disabled:""},null,8,["value"]),j(f(I),null,{default:b(()=>[...t[3]||(t[3]=[g("连接状态",-1)])]),_:1}),j(f(P),{label:"mqtt代理通路"},{default:b(()=>[j(f(N),{value:r.value},{checked:b(()=>[...t[4]||(t[4]=[g(" 已连接 ",-1)])]),unchecked:b(()=>[...t[5]||(t[5]=[g(" 连接中 ",-1)])]),_:1},8,["value"])]),_:1}),j(f(P),{label:"订阅主题"},{default:b(()=>[j(f(D),{value:o.topic,disabled:""},null,8,["value"])]),_:1}),j(f(I),null,{default:b(()=>[...t[6]||(t[6]=[g("信息日志列表",-1)])]),_:1}),j(f($),{log:y.value.join("\n"),rows:12},null,8,["log"]),j(f(I),null,{default:b(()=>[...t[7]||(t[7]=[g("通过mqtt交互状态",-1)])]),_:1}),t[8]||(t[8]=g(" 开关电风扇 : ",-1)),j(f(N),{loading:s.value,round:!1,value:a.value,"onUpdate:value":[t[0]||(t[0]=e=>a.value=e),T]},null,8,["loading","value"])]),_:1})]))}}),B=["object"],H=r({__name:"efanModel",props:{color:{type:String,required:!0}},async setup(s){let o,l;const i=s,{nodes:r,animations:n}=([o,l]=y(()=>C("https://opensource.cdn.icegl.cn/model/eCommerce/eFan/nFan.gltf")),o=await o,l(),o),u=e=>r.Sketchfab_model.getObjectByName(e).geometry.attributes.uv.array,m={Object_4:new Float32Array(u("Object_4")),Object_8:new Float32Array(u("Object_8")),Object_6:new Float32Array(u("Object_6")),Object_6001:new Float32Array(u("Object_6001"))},g=r.Sketchfab_model.getObjectByName("Object_6001"),{actions:O}=e(n,r.Sketchfab_model),T=O.Animation,k=p("animationPlay");return c(()=>i.color,e=>{(e=>{const t={"#ff8b04":0,"#999999":.04,"#d3ac10":.19,"#ffbec4":-.06,"#d0d5c6":.55};for(const[a,s]of Object.entries(m)){for(let o=0;o<u(a).length;o++)u(a)[o]=s[o]+t[e];r.Sketchfab_model.getObjectByName(a).geometry.getAttribute("uv").needsUpdate=!0}})(e)},{immediate:!0}),c(()=>k.value,e=>{e?(T.reset().play(),g?.rotateY(-Math.PI)):(T.fadeOut(.6).paused=!0,g?.rotateY(Math.PI))},{immediate:!0}),(e,s)=>(v(),d(_,null,[j(f(t),{range:[-.5,-.5],speed:2},{default:b(()=>[h("primitive",{position:[-2,0,0],object:w(f(r).Sketchfab_model),scale:3},null,8,B)]),_:1}),j(f(a),{opacity:.3,blur:2.6,position:[0,-2,0]})],64))}}),J=r({__name:"withModel",setup(e){const t={shadows:!0,alpha:!0,shadowMapType:l,outputColorSpace:o,windowSize:!0,clearColor:"#ffffff"},a=n(!1);return A("animationPlay",a),(e,a)=>{const o=O("TresCanvas");return v(),d(_,null,[j(o,q(x(t)),{default:b(()=>[a[0]||(a[0]=h("TresPerspectiveCamera",{position:[10,5,-8],fov:45,near:.1,far:1e5},null,-1)),j(f(s),{enableDamping:""}),(v(),T(k,null,{default:b(()=>[j(H,{color:"#ff8b04"})]),_:1})),a[1]||(a[1]=h("TresAmbientLight",{intensity:2},null,-1)),a[2]||(a[2]=h("TresPointLight",{position:[0,0,10],intensity:1},null,-1)),a[3]||(a[3]=h("TresDirectionalLight",{position:[3,3,3],intensity:3},null,-1))]),_:1},16),j(f(z),null,{default:b(()=>[j(Q)]),_:1})],64)}}});export{J as default};
