import{P as e}from"./tweakpane.CqZAnw7f1764683399638.js";import{F as o,N as s,H as a,_ as r,K as t}from"./@tresjs.CJvYCGUA1764683399638.js";import"./index.DM693cYN1764683399638.js";import{_ as i}from"./reflectorDUDV.vue_vue_type_script_setup_true_lang.u89pth7i1764683399638.js";import{o as n,k as l,cT as c,cR as m,cS as p,d,dh as u,dq as v,dr as f}from"./three.BbguFgn81764683399638.js";import{d as j,c as h,w as g,q as b,G as w,H as y,o as _,I as x,u as D,r as P,b as M,e as k,f as U,h as S,ah as q,a9 as T,aa as z}from"./@vue.DjQnunkc1764683399638.js";import"./postprocessing.DjqPXL_K1764683399638.js";import"./@vueuse.BBrxj3Xz1764683399638.js";import"./@fesjs.CQdxRiFD1764683399638.js";import"./vue-router.CW9J5iK31764683399638.js";import"./lodash-es.DWe8oqPO1764683399638.js";import"./pinia.yp40krTn1764683399638.js";import"./@qlin.y-0Z8WnK1764683399638.js";import"./@babel.BPq7uOAK1764683399638.js";import"./@floating-ui.Bhq4ibgf1764683399638.js";import"./@juggle.Vc7cP4_P1764683399638.js";import"./chalk.BHLFMujs1764683399638.js";/* empty css                                 */import"./iconify-icon.Dg3Wmqac1764683399638.js";import"./@iconify.Db0UMRdG1764683399638.js";import"./vite-plugin-qiankun.B06WoCqG1764683399638.js";import"./dompurify.C4MEnGDh1764683399638.js";import"./color.D_UQSrzA1764683399638.js";import"./color-string.cWrXb_cU1764683399638.js";import"./color-name.gyPnsvCn1764683399638.js";import"./lodash.OvYRBTRe1764683399638.js";import"./@amap.fjyZdsU91764683399638.js";import"./object-hash.C0HZ2EUZ1764683399638.js";import"./jszip.CqykFGTv1764683399638.js";import"./oimophysics.CfVKSiAm1764683399638.js";import"./three-stdlib.CqpxBIJB1764683399638.js";import"./@pmndrs.CRF-_adI1764683399638.js";import"./axios.Bl1IyXmH1764683399638.js";import"./dither.glsl.tNAdkJUa1764683399638.js";import"./Reflector.DiEbG3XV1764683399638.js";const C={key:0},F=["object"],G=["object"],H=["object"],I=j({__name:"mechaFloor",props:{color:{default:"#ffed00"}},setup(e){const{renderer:t,scene:i,camera:j,sizes:P}=o(),M=e;let k=null;const U={uniforms:{tDiffuse:{value:null},contrast:{value:1.8}},vertexShader:"\n        varying vec2 vUv;\n        void main() {\n            vUv = uv;\n            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n    ",fragmentShader:"\n        uniform sampler2D tDiffuse;\n        uniform float contrast;\n        varying vec2 vUv;\n        void main() {\n            vec4 color = texture2D(tDiffuse, vUv);\n            color.rgb = (color.rgb - 0.5) * contrast + 0.8;\n            gl_FragColor = color;\n        }\n    "},{state:S}=s("https://opensource.cdn.icegl.cn/model/floor/baseModelJ.glb",{draco:!0,decoderPath:"./draco/"}),q=h(()=>S?.value?.scene),{state:T}=s("plugins/floor/models/topoBase/baseModelL.glb",{draco:!0,decoderPath:"./draco/"}),{state:z}=s("https://opensource.cdn.icegl.cn/model/floor/baseModelK.glb",{draco:!0,decoderPath:"./draco/"}),I=h(()=>z.value?.animations||[]),R=h(()=>z?.value?.scene),{actions:A}=a(I,R);g(A,e=>{e.Scene&&e.Scene.play()}),g(q,e=>{e&&e.traverse(e=>{e instanceof n&&(e.material.emissive=new l("#ffed00"),e.material.emissiveIntensity=20.5,e.material.toneMapped=!0,e.material.needsUpdate=!0)})});const{onRender:B}=r();return B(()=>{k&&k.render()}),b(()=>{(()=>{const e=new v(t),o=new f,s=e.fromScene(o).texture;i.value.environment=s,q.value&&q.value.traverse(e=>{e instanceof n&&e.material&&(e.material.envMap=s,e.material.needsUpdate=!0)}),o.dispose()})(),setTimeout(()=>{(()=>{if(!t||!j.value||!P.width.value)return;k=new c(t);const e=new m(i.value,j.value);k.addPass(e);const o=new p(new d(P.width.value,P.height.value),.1,.1,.1);k.addPass(o);const s=new u(U);s.uniforms.contrast.value=1.1,k.addPass(s)})()},200)}),g(()=>[M.color],([e])=>{q.value&&q.value.traverse(o=>{o instanceof n&&o.material&&(o.material.emissive=new l(e))})}),(e,o)=>q.value&&R.value?(_(),w("TresGroup",C,[x("primitive",{object:q.value,"position-y":.01},null,8,F),D(T)?(_(),w("primitive",{key:0,object:D(T)?.scene,"position-y":.1},null,8,G)):y("",!0),x("primitive",{object:R.value,"position-y":.1},null,8,H)])):y("",!0)}}),R=j({__name:"mechaFloor",setup(o){const s=P({color:"#ffed00"}),a=new e({expanded:!0}),r={reflectivity:1,showGridHelper:!1,scale:2,renderMode:"manual"};return a.addBinding(s,"color",{label:"颜色"}),(e,o)=>{const a=M("TresCanvas");return _(),k(a,{clearColor:"#000000","window-size":""},{default:U(()=>[o[0]||(o[0]=x("TresPerspectiveCamera",{position:[3,5,0],fov:45,near:.1,far:1e4},null,-1)),S(D(t),{enableDamping:""}),(_(),k(q,null,{default:U(()=>[S(D(I),T(z(s)),null,16)]),_:1})),S(i,T(z(r)),null,16)]),_:1})}}});export{R as default};
