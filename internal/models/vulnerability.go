package models

import (
	"go.mongodb.org/mongo-driver/bson/primitive"
)

// Vulnerability 表示一个漏洞记录
type Vulnerability struct {
	ID         primitive.ObjectID `bson:"_id,omitempty" json:"id"`
	VulnId     string             `bson:"vulnid" json:"vulnid"`
	Url        string             `bson:"url" json:"url"`
	VulName    string             `bson:"vulname" json:"vulnerability"`
	Matched    string             `bson:"matched" json:"matched"`
	Project    string             `bson:"project" json:"project"`
	Level      string             `bson:"level" json:"level"`
	Time       string             `bson:"time" json:"time"`
	Request    string             `bson:"request" json:"request"`
	Response   string             `bson:"response" json:"response"`
	TaskName   string             `bson:"taskName" json:"taskName"`
	RootDomain string             `bson:"rootDomain" json:"rootDomain"`
	Hash       string             `bson:"hash" json:"hash"`
	Tags       []string           `bson:"tags" json:"tags"`
	Status     int                `bson:"status" json:"status"` // 1表示未处理 2表示处理中 3表示忽略 4表示疑似 5表示确认
}

type VulnerabilityResponse struct {
	List  []Vulnerability `json:"list"`
	Total int64           `json:"total"`
}

// VulnerabilityDetail 表示漏洞详情记录（存储请求和响应）
type VulnerabilityDetail struct {
	ID       primitive.ObjectID `bson:"_id,omitempty" json:"id"`
	Hash     string             `bson:"hash" json:"hash"`
	Request  string             `bson:"req" json:"req"`
	Response string             `bson:"res" json:"res"`
}
